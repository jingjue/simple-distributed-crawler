2022-05-13 16:03:48.425 | ERROR    | monitor.searchSpiders.tieba:get_request_from_keyword:34 - E 贴吧错误HTTPSConnectionPool(host='wappass.baidu.com', port=443): Max retries exceeded with url: /static/captcha/tuxing.html?ak=2ef521ec36290baed33d66de9b16f625&backurl=http%3A%2F%2Ftieba.baidu.com%2Ff%2Fsearch%2Fres%3Fisnew%3D1%26kw%3D%26qw%3D%25E4%25BB%258E%25E7%25AE%25A1%25E6%258E%25A7%25E5%258C%25BA%25E7%25BF%25BB%25E5%25A2%2599%25E5%25A4%2596%25E5%2587%25BA%25E5%2581%259A%25E2%2580%259C%25E5%259B%25A2%25E8%25B4%25AD%25E2%2580%259D%25E2%2580%259C%25E8%25B7%2591%25E8%2585%25BF%25E2%2580%259D%25EF%25BC%258C%25E4%25B8%2580%25E5%25A5%25B3%25E5%25AD%2590%25E8%25A2%25AB%25E4%25B8%258A%25E6%25B5%25B7%25E8%25AD%25A6%25E6%2596%25B9%25E5%25A4%2584%25E7%25BD%259A%26rn%3D10%26un%3D%26only_thread%3D0%26sm%3D1%26sd%3D%26ed%3D%26pn%3D3&timestamp=1652429028&signature=5f42d69abac78a59345af0dbaaf4e9af (Caused by SSLError(SSLError(1, '[SSL: SSLV3_ALERT_HANDSHAKE_FAILURE] sslv3 alert handshake failure (_ssl.c:1131)')))
Traceback (most recent call last):

  File "/home/chase/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 699, in urlopen
    httplib_response = self._make_request(
                       │    └ <function HTTPConnectionPool._make_request at 0x7fa25383dca0>
                       └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fa1608a1670>
  File "/home/chase/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 382, in _make_request
    self._validate_conn(conn)
    │    │              └ <urllib3.connection.HTTPSConnection object at 0x7fa1602f6dc0>
    │    └ <function HTTPSConnectionPool._validate_conn at 0x7fa25383e1f0>
    └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fa1608a1670>
  File "/home/chase/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 1010, in _validate_conn
    conn.connect()
    │    └ <function HTTPSConnection.connect at 0x7fa25382d8b0>
    └ <urllib3.connection.HTTPSConnection object at 0x7fa1602f6dc0>
  File "/home/chase/.local/lib/python3.8/site-packages/urllib3/connection.py", line 416, in connect
    self.sock = ssl_wrap_socket(
    │    │      └ <function ssl_wrap_socket at 0x7fa2538935e0>
    │    └ None
    └ <urllib3.connection.HTTPSConnection object at 0x7fa1602f6dc0>
  File "/home/chase/.local/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 449, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
               └ <function _ssl_wrap_socket_impl at 0x7fa253893790>
  File "/home/chase/.local/lib/python3.8/site-packages/urllib3/util/ssl_.py", line 493, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
           │           │           │                     └ 'wappass.baidu.com'
           │           │           └ <socket.socket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
           │           └ <function SSLContext.wrap_socket at 0x7fa26d042e50>
           └ <ssl.SSLContext object at 0x7fa161bd2740>
  File "/usr/lib/python3.8/ssl.py", line 500, in wrap_socket
    return self.sslsocket_class._create(
           │    │               └ <classmethod object at 0x7fa278783af0>
           │    └ <class 'ssl.SSLSocket'>
           └ <ssl.SSLContext object at 0x7fa161bd2740>
  File "/usr/lib/python3.8/ssl.py", line 1040, in _create
    self.do_handshake()
    │    └ <function SSLSocket.do_handshake at 0x7fa27878ad30>
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>
  File "/usr/lib/python3.8/ssl.py", line 1309, in do_handshake
    self._sslobj.do_handshake()
    │    └ None
    └ <ssl.SSLSocket [closed] fd=-1, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6>

ssl.SSLError: [SSL: SSLV3_ALERT_HANDSHAKE_FAILURE] sslv3 alert handshake failure (_ssl.c:1131)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/home/chase/.local/lib/python3.8/site-packages/requests/adapters.py", line 439, in send
    resp = conn.urlopen(
           │    └ <function HTTPConnectionPool.urlopen at 0x7fa25383dee0>
           └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fa1608a1670>
  File "/home/chase/.local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 755, in urlopen
    retries = retries.increment(
              │       └ <function Retry.increment at 0x7fa253880280>
              └ Retry(total=0, connect=None, read=False, redirect=None, status=None)
  File "/home/chase/.local/lib/python3.8/site-packages/urllib3/util/retry.py", line 574, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
          │             │      │    │        │             └ 'unknown'
          │             │      │    │        └ <class 'urllib3.exceptions.ResponseError'>
          │             │      │    └ SSLError(SSLError(1, '[SSL: SSLV3_ALERT_HANDSHAKE_FAILURE] sslv3 alert handshake failure (_ssl.c:1131)'))
          │             │      └ '/static/captcha/tuxing.html?ak=2ef521ec36290baed33d66de9b16f625&backurl=http%3A%2F%2Ftieba.baidu.com%2Ff%2Fsearch%2Fres%3Fis...
          │             └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x7fa1608a1670>
          └ <class 'urllib3.exceptions.MaxRetryError'>

urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='wappass.baidu.com', port=443): Max retries exceeded with url: /static/captcha/tuxing.html?ak=2ef521ec36290baed33d66de9b16f625&backurl=http%3A%2F%2Ftieba.baidu.com%2Ff%2Fsearch%2Fres%3Fisnew%3D1%26kw%3D%26qw%3D%25E4%25BB%258E%25E7%25AE%25A1%25E6%258E%25A7%25E5%258C%25BA%25E7%25BF%25BB%25E5%25A2%2599%25E5%25A4%2596%25E5%2587%25BA%25E5%2581%259A%25E2%2580%259C%25E5%259B%25A2%25E8%25B4%25AD%25E2%2580%259D%25E2%2580%259C%25E8%25B7%2591%25E8%2585%25BF%25E2%2580%259D%25EF%25BC%258C%25E4%25B8%2580%25E5%25A5%25B3%25E5%25AD%2590%25E8%25A2%25AB%25E4%25B8%258A%25E6%25B5%25B7%25E8%25AD%25A6%25E6%2596%25B9%25E5%25A4%2584%25E7%25BD%259A%26rn%3D10%26un%3D%26only_thread%3D0%26sm%3D1%26sd%3D%26ed%3D%26pn%3D3&timestamp=1652429028&signature=5f42d69abac78a59345af0dbaaf4e9af (Caused by SSLError(SSLError(1, '[SSL: SSLV3_ALERT_HANDSHAKE_FAILURE] sslv3 alert handshake failure (_ssl.c:1131)')))


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fa27b7e4a60>
    └ <Thread(Thread-266, started daemon 140331097319168)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fa27b7e4790>
    └ <Thread(Thread-266, started daemon 140331097319168)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-266, started daemon 140331097319168)>
    │    │        │    └ ('ProjectManager.run_func_by_thread',)
    │    │        └ <Thread(Thread-266, started daemon 140331097319168)>
    │    └ <bound method ProjectManager.get_request_from_keywords_hot of <monitor.projectManager.ProjectManager object at 0x7fa163b9f250>>
    └ <Thread(Thread-266, started daemon 140331097319168)>

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 815, in get_request_from_keywords_hot
    self.search_spider_manager.crawl_by_keyword(
    │    │                     └ <function SearchSpidersManager.crawl_by_keyword at 0x7fa163ba1f70>
    │    └ <monitor.spiderManager.SearchSpidersManager object at 0x7fa1637d04f0>
    └ <monitor.projectManager.ProjectManager object at 0x7fa163b9f250>

  File "/home/users/Scy/yuqing/spider/monitor/spiderManager.py", line 118, in crawl_by_keyword
    self.crawl_by_keyword_signal_platform(project_names, platform, keyword, crawl_time, project_times, titles)
    │    │                                │              │         │        │           │              └ None
    │    │                                │              │         │        │           └ {'default': <monitor.TimeSection object at 0x7fa1638c4c10>, 'test': <monitor.TimeSection object at 0x7fa16385b880>}
    │    │                                │              │         │        └ <monitor.TimeSection object at 0x7fa161e39bb0>
    │    │                                │              │         └ '从管控区翻墙外出做“团购”“跑腿”，一女子被上海警方处罚'
    │    │                                │              └ '贴吧'
    │    │                                └ ['default']
    │    └ <function SearchSpidersManager.crawl_by_keyword_signal_platform at 0x7fa163ba30d0>
    └ <monitor.spiderManager.SearchSpidersManager object at 0x7fa1637d04f0>

  File "/home/users/Scy/yuqing/spider/monitor/spiderManager.py", line 145, in crawl_by_keyword_signal_platform
    requests = self.get_request_from_keyword(platform, keyword, **crawl_time.to_dict())
               │    │                        │         │          │          └ <function TimeSection.to_dict at 0x7fa259befa60>
               │    │                        │         │          └ <monitor.TimeSection object at 0x7fa161e39bb0>
               │    │                        │         └ '从管控区翻墙外出做“团购”“跑腿”，一女子被上海警方处罚'
               │    │                        └ '贴吧'
               │    └ <function SearchSpidersManager.get_request_from_keyword at 0x7fa163ba31f0>
               └ <monitor.spiderManager.SearchSpidersManager object at 0x7fa1637d04f0>

  File "/home/users/Scy/yuqing/spider/monitor/spiderManager.py", line 209, in get_request_from_keyword
    for request in self.spiders[platform].get_request_from_keyword(headers, search_url, keyword, content_url,
                   │    │       │                                  │        │           │        └ None
                   │    │       │                                  │        │           └ '从管控区翻墙外出做“团购”“跑腿”，一女子被上海警方处罚'
                   │    │       │                                  │        └ <string.Template object at 0x7fa160aa25b0>
                   │    │       │                                  └ {'Connection': 'keep-alive', 'sec-ch-ua': "'Chromium';v='92',' Not A;Brand';v='99', 'Google Chrome';v='92'", 'sec-ch-ua-mobil...
                   │    │       └ '贴吧'
                   │    └ {'凤凰网': <monitor.searchSpiders.ifeng.Ifeng object at 0x7fa1637d0070>, '头条': <monitor.searchSpiders.toutiao.Toutiao object at ...
                   └ <monitor.spiderManager.SearchSpidersManager object at 0x7fa1637d04f0>

> File "/home/users/Scy/yuqing/spider/monitor/searchSpiders/tieba.py", line 22, in get_request_from_keyword
    response = requests.get(url, headers=headers, timeout=50)
               │        │   │            └ {'Connection': 'keep-alive', 'sec-ch-ua': "'Chromium';v='92',' Not A;Brand';v='99', 'Google Chrome';v='92'", 'sec-ch-ua-mobil...
               │        │   └ 'https://tieba.baidu.com/f/search/res?isnew=1&kw=&qw=从管控区翻墙外出做“团购”“跑腿”，一女子被上海警方处罚&rn=10&un=&only_thread=0&sm=1&sd=&ed=&pn=3'
               │        └ <function get at 0x7fa2536b7430>
               └ <module 'requests' from '/home/chase/.local/lib/python3.8/site-packages/requests/__init__.py'>

  File "/home/chase/.local/lib/python3.8/site-packages/requests/api.py", line 75, in get
    return request('get', url, params=params, **kwargs)
           │              │           │         └ {'headers': {'Connection': 'keep-alive', 'sec-ch-ua': "'Chromium';v='92',' Not A;Brand';v='99', 'Google Chrome';v='92'", 'sec...
           │              │           └ None
           │              └ 'https://tieba.baidu.com/f/search/res?isnew=1&kw=&qw=从管控区翻墙外出做“团购”“跑腿”，一女子被上海警方处罚&rn=10&un=&only_thread=0&sm=1&sd=&ed=&pn=3'
           └ <function request at 0x7fa2536a8280>
  File "/home/chase/.local/lib/python3.8/site-packages/requests/api.py", line 61, in request
    return session.request(method=method, url=url, **kwargs)
           │       │              │           │      └ {'params': None, 'headers': {'Connection': 'keep-alive', 'sec-ch-ua': "'Chromium';v='92',' Not A;Brand';v='99', 'Google Chrom...
           │       │              │           └ 'https://tieba.baidu.com/f/search/res?isnew=1&kw=&qw=从管控区翻墙外出做“团购”“跑腿”，一女子被上海警方处罚&rn=10&un=&only_thread=0&sm=1&sd=&ed=&pn=3'
           │       │              └ 'get'
           │       └ <function Session.request at 0x7fa2536c0b80>
           └ <requests.sessions.Session object at 0x7fa1603043a0>
  File "/home/chase/.local/lib/python3.8/site-packages/requests/sessions.py", line 542, in request
    resp = self.send(prep, **send_kwargs)
           │    │    │       └ {'timeout': 50, 'allow_redirects': True, 'verify': True, 'proxies': OrderedDict(), 'stream': False, 'cert': None}
           │    │    └ <PreparedRequest [GET]>
           │    └ <function Session.send at 0x7fa2536b7040>
           └ <requests.sessions.Session object at 0x7fa1603043a0>
  File "/home/chase/.local/lib/python3.8/site-packages/requests/sessions.py", line 677, in send
    history = [resp for resp in gen]
                                └ <generator object SessionRedirectMixin.resolve_redirects at 0x7fa1605d8350>
  File "/home/chase/.local/lib/python3.8/site-packages/requests/sessions.py", line 677, in <listcomp>
    history = [resp for resp in gen]
  File "/home/chase/.local/lib/python3.8/site-packages/requests/sessions.py", line 237, in resolve_redirects
    resp = self.send(
           │    └ <function Session.send at 0x7fa2536b7040>
           └ <requests.sessions.Session object at 0x7fa1603043a0>
  File "/home/chase/.local/lib/python3.8/site-packages/requests/sessions.py", line 655, in send
    r = adapter.send(request, **kwargs)
        │       │    │          └ {'stream': False, 'timeout': 50, 'verify': True, 'cert': None, 'proxies': OrderedDict()}
        │       │    └ <PreparedRequest [GET]>
        │       └ <function HTTPAdapter.send at 0x7fa2536c04c0>
        └ <requests.adapters.HTTPAdapter object at 0x7fa16068bca0>
  File "/home/chase/.local/lib/python3.8/site-packages/requests/adapters.py", line 514, in send
    raise SSLError(e, request=request)
          │                   └ <PreparedRequest [GET]>
          └ <class 'requests.exceptions.SSLError'>

requests.exceptions.SSLError: HTTPSConnectionPool(host='wappass.baidu.com', port=443): Max retries exceeded with url: /static/captcha/tuxing.html?ak=2ef521ec36290baed33d66de9b16f625&backurl=http%3A%2F%2Ftieba.baidu.com%2Ff%2Fsearch%2Fres%3Fisnew%3D1%26kw%3D%26qw%3D%25E4%25BB%258E%25E7%25AE%25A1%25E6%258E%25A7%25E5%258C%25BA%25E7%25BF%25BB%25E5%25A2%2599%25E5%25A4%2596%25E5%2587%25BA%25E5%2581%259A%25E2%2580%259C%25E5%259B%25A2%25E8%25B4%25AD%25E2%2580%259D%25E2%2580%259C%25E8%25B7%2591%25E8%2585%25BF%25E2%2580%259D%25EF%25BC%258C%25E4%25B8%2580%25E5%25A5%25B3%25E5%25AD%2590%25E8%25A2%25AB%25E4%25B8%258A%25E6%25B5%25B7%25E8%25AD%25A6%25E6%2596%25B9%25E5%25A4%2584%25E7%25BD%259A%26rn%3D10%26un%3D%26only_thread%3D0%26sm%3D1%26sd%3D%26ed%3D%26pn%3D3&timestamp=1652429028&signature=5f42d69abac78a59345af0dbaaf4e9af (Caused by SSLError(SSLError(1, '[SSL: SSLV3_ALERT_HANDSHAKE_FAILURE] sslv3 alert handshake failure (_ssl.c:1131)')))
2022-05-13 16:03:58.307 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/1/1/2/177705855.html
2022-05-13 16:08:35.938 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/1/1/2/177707523.html
2022-05-13 16:09:45.835 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/1/1/2/177705855.html
2022-05-13 16:10:08.995 | ERROR    | base.db.mysql:update:390 - 【mysql更新数据出错】
Traceback (most recent call last):

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa160a9a940>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '9175450257495835200314962946...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa160a94400>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='9175450257495835200314...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa160a94400>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='9175450257495835200314...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa160a94370>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa160a94370>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa160a943a0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa160a943a0>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

pymysql.err.IntegrityError: (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fa27b7e4a60>
    └ <Thread(Thread-435, started daemon 140330598917888)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fa27b7e4790>
    └ <Thread(Thread-435, started daemon 140330598917888)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-435, started daemon 140330598917888)>
    │    │        │    └ ('ProjectManager.run_func_by_thread',)
    │    │        └ <Thread(Thread-435, started daemon 140330598917888)>
    │    └ <bound method ProjectManager.get_request_from_keywords_hot of <monitor.projectManager.ProjectManager object at 0x7fa163b9f250>>
    └ <Thread(Thread-435, started daemon 140330598917888)>

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 799, in get_request_from_keywords_hot
    self.start_finished_spider_every_interval(project_names)
    │    │                                    └ ['default', 'test']
    │    └ <function ProjectManager.start_finished_spider_every_interval at 0x7fa1638be280>
    └ <monitor.projectManager.ProjectManager object at 0x7fa163b9f250>

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 784, in start_finished_spider_every_interval
    self[name].start_spider()
    │    └ 'default'
    └ <monitor.projectManager.ProjectManager object at 0x7fa163b9f250>

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 366, in start_spider
    self.update_device_valid(device)
    │    │                   └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    └ <function Project.update_device_valid at 0x7fa1638bc280>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 421, in update_device_valid
    self.database_manager.mysql.update(Device(**device.to_item()))
    │    │                │     │      │        │      └ <function DeviceC.to_item at 0x7fa252daa310>
    │    │                │     │      │        └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    │                │     │      └ <class 'base.db.mysql.Device'>
    │    │                │     └ <function Mysql.update at 0x7fa252eb1790>
    │    │                └ <base.db.mysql.Mysql object at 0x7fa1638b6f40>
    │    └ <base.db.dbSlot.Slot object at 0x7fa1638b6e80>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

> File "/home/users/Scy/yuqing/spider/base/db/mysql.py", line 375, in update
    row.update(new)
    │   │      └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '9175450257495835200314962946...
    │   └ <function Query.update at 0x7fa252ff03a0>
    └ <sqlalchemy.orm.query.Query object at 0x7fa161c5faf0>

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/query.py", line 3221, in update
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7fa252fccaf0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7fa161c5f490>
             └ <sqlalchemy.orm.query.Query object at 0x7fa161c5faf0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 1689, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa160a94c40>
             │    └ <function Connection._execute_20 at 0x7fa253279790>
             └ <sqlalchemy.engine.base.Connection object at 0x7fa160a9a940>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1583, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fa160a9a940>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa160a94c40>>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 323, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fa2532795e0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fa160a9a940>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1452, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fa2532798b0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fa160a9a940>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1814, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fa253279a60>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa160a9a940>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1995, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fa25363aa60>
    └ <module 'sqlalchemy.util' from '/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/__init__.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa160a9a940>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '9175450257495835200314962946...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa160a94400>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='9175450257495835200314...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa160a94400>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='9175450257495835200314...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa160a94370>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa160a94370>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa160a943a0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa160a943a0>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")
[SQL: UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, port=%(port)s, valid=%(valid)s WHERE device.ip = %(ip_1)s]
[parameters: {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '91754502574958352003149629463112281142739435984922913836345829938901636744999841437871986198615764496921711159310987721381525838444629163436734053079 ... (10 characters truncated) ... 69303988298332487907912099666755330257511008719455003115437016627566225796642460269071796273420865119708659585657021665648521440321233630964010388619', 'address': '/home/users/CT/pycharmproject/spiders/', 'port': 6800, 'valid': 1, 'ip_1': '180.201.163.246'}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-05-13 16:10:31.640 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/1/1/2/177707523.html
2022-05-13 16:10:38.722 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/1/1/2/177707523.html
2022-05-13 16:11:22.920 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/1/1/2/177706759.html
2022-05-13 16:11:28.063 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/1/1/2/177702921.html
2022-05-13 16:11:46.615 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/2/1/2/177703643.html
2022-05-13 16:11:56.817 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/1/1/2/177705855.html
2022-05-13 16:12:07.054 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/1/1/2/177705855.html
2022-05-13 16:19:10.008 | ERROR    | monitor.searchSpiders.weibo:get_request_from_keyword:63 - E 微博检索 502
2022-05-13 16:20:26.950 | ERROR    | base.db.mysql:update:390 - 【mysql更新数据出错】
Traceback (most recent call last):

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa161d69910>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '9110792806324766596193652881...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa161d695e0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='9110792806324766596193...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa161d695e0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='9110792806324766596193...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa160b3ad00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa160b3ad00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa160b3a7c0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa160b3a7c0>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

pymysql.err.IntegrityError: (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fa27b7e4a60>
    └ <Thread(Thread-507, started daemon 140330586855168)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fa27b7e4790>
    └ <Thread(Thread-507, started daemon 140330586855168)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-507, started daemon 140330586855168)>
    │    │        │    └ ('ProjectManager.run_func_by_thread',)
    │    │        └ <Thread(Thread-507, started daemon 140330586855168)>
    │    └ <bound method ProjectManager.get_request_from_keywords_hot of <monitor.projectManager.ProjectManager object at 0x7fa163b9f250>>
    └ <Thread(Thread-507, started daemon 140330586855168)>

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 799, in get_request_from_keywords_hot
    self.start_finished_spider_every_interval(project_names)
    │    │                                    └ ['default', 'test']
    │    └ <function ProjectManager.start_finished_spider_every_interval at 0x7fa1638be280>
    └ <monitor.projectManager.ProjectManager object at 0x7fa163b9f250>

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 784, in start_finished_spider_every_interval
    self[name].start_spider()
    │    └ 'default'
    └ <monitor.projectManager.ProjectManager object at 0x7fa163b9f250>

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 366, in start_spider
    self.update_device_valid(device)
    │    │                   └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    └ <function Project.update_device_valid at 0x7fa1638bc280>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 421, in update_device_valid
    self.database_manager.mysql.update(Device(**device.to_item()))
    │    │                │     │      │        │      └ <function DeviceC.to_item at 0x7fa252daa310>
    │    │                │     │      │        └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    │                │     │      └ <class 'base.db.mysql.Device'>
    │    │                │     └ <function Mysql.update at 0x7fa252eb1790>
    │    │                └ <base.db.mysql.Mysql object at 0x7fa1638b6f40>
    │    └ <base.db.dbSlot.Slot object at 0x7fa1638b6e80>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

> File "/home/users/Scy/yuqing/spider/base/db/mysql.py", line 375, in update
    row.update(new)
    │   │      └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '9110792806324766596193652881...
    │   └ <function Query.update at 0x7fa252ff03a0>
    └ <sqlalchemy.orm.query.Query object at 0x7fa160aa25b0>

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/query.py", line 3221, in update
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7fa252fccaf0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7fa1604541f0>
             └ <sqlalchemy.orm.query.Query object at 0x7fa160aa25b0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 1689, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa161d69d00>
             │    └ <function Connection._execute_20 at 0x7fa253279790>
             └ <sqlalchemy.engine.base.Connection object at 0x7fa161d69910>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1583, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fa161d69910>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa161d69d00>>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 323, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fa2532795e0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fa161d69910>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1452, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fa2532798b0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fa161d69910>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1814, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fa253279a60>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa161d69910>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1995, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fa25363aa60>
    └ <module 'sqlalchemy.util' from '/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/__init__.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa161d69910>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '9110792806324766596193652881...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa161d695e0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='9110792806324766596193...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa161d695e0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='9110792806324766596193...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa160b3ad00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa160b3ad00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa160b3a7c0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa160b3a7c0>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")
[SQL: UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, port=%(port)s, valid=%(valid)s WHERE device.ip = %(ip_1)s]
[parameters: {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '91107928063247665961936528812743476868794482162388657210833083862890630691870624054630727339235150273817546541137591541523813189062456629356254939486 ... (10 characters truncated) ... 55873977520896988790882203896726683620545052673353717402170044364428136317940583217912580338593462103229976389123305171694079920491945024671688644071', 'address': '/home/users/CT/pycharmproject/spiders/', 'port': 6800, 'valid': 1, 'ip_1': '180.201.163.246'}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-05-13 16:20:59.520 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/1/1/2/177712543.html
2022-05-13 16:20:59.523 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/2/1/2/177712142.html
2022-05-13 16:21:07.848 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/1/1/2/177707142.html
2022-05-13 16:21:24.571 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/2/1/2/177698723.html
2022-05-13 16:21:33.006 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/2/1/2/177707041.html
2022-05-13 16:21:47.106 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/1/1/2/177706759.html
2022-05-13 16:21:55.426 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/1/1/2/177702921.html
2022-05-13 16:22:21.160 | ERROR    | base.utils.time:people_time_from_url:173 - 【url error】url:http://bbs1.people.com.cn/post/2/1/2/177703643.html
2022-05-13 16:25:50.703 | ERROR    | base.db.mysql:update:390 - 【mysql更新数据出错】
Traceback (most recent call last):

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa160b3af40>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '1388644135484522009473673397...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa160381790>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='1388644135484522009473...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa160381790>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='1388644135484522009473...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa1608662e0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa1608662e0>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa1608662e0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa160b3a280>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa160b3a280>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa160b3a1c0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa160b3a1c0>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

pymysql.err.IntegrityError: (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fa27b7e4a60>
    └ <Thread(Thread-549, started daemon 140330575054592)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fa27b7e4790>
    └ <Thread(Thread-549, started daemon 140330575054592)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-549, started daemon 140330575054592)>
    │    │        │    └ (<socket.socket fd=21, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), r...
    │    │        └ <Thread(Thread-549, started daemon 140330575054592)>
    │    └ <bound method ThreadingMixIn.process_request_thread of <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>>
    └ <Thread(Thread-549, started daemon 140330575054592)>
  File "/usr/lib/python3.8/socketserver.py", line 683, in process_request_thread
    self.finish_request(request, client_address)
    │    │              │        └ ('180.201.152.222', 60536)
    │    │              └ <socket.socket fd=21, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), ra...
    │    └ <function BaseServer.finish_request at 0x7fa26d121310>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
  File "/usr/lib/python3.8/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    │    │                   │        │               └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
    │    │                   │        └ ('180.201.152.222', 60536)
    │    │                   └ <socket.socket fd=21, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), ra...
    │    └ <class 'werkzeug.serving.WSGIRequestHandler'>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
  File "/usr/lib/python3.8/socketserver.py", line 747, in __init__
    self.handle()
    │    └ <function WSGIRequestHandler.handle at 0x7fa25c841e50>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa160b40130>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 342, in handle
    BaseHTTPRequestHandler.handle(self)
    │                      │      └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa160b40130>
    │                      └ <function BaseHTTPRequestHandler.handle at 0x7fa278793430>
    └ <class 'http.server.BaseHTTPRequestHandler'>

  File "/usr/lib/python3.8/http/server.py", line 427, in handle
    self.handle_one_request()
    │    └ <function WSGIRequestHandler.handle_one_request at 0x7fa25c846040>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa160b40130>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 374, in handle_one_request
    self.run_wsgi()
    │    └ <function WSGIRequestHandler.run_wsgi at 0x7fa25c841dc0>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa160b40130>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 319, in run_wsgi
    execute(self.server.app)
    │       │    │      └ <Flask 'app'>
    │       │    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
    │       └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa160b40130>
    └ <function WSGIRequestHandler.run_wsgi.<locals>.execute at 0x7fa161d040d0>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 308, in execute
    application_iter = app(environ, start_response)
                       │   │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7fa161d041f0>
                       │   └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=21>, 'wsgi.errors': <_io.TextIOWra...
                       └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 2464, in __call__
    return self.wsgi_app(environ, start_response)
           │    │        │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7fa161d041f0>
           │    │        └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=21>, 'wsgi.errors': <_io.TextIOWra...
           │    └ <function Flask.wsgi_app at 0x7fa25c354c10>
           └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 2447, in wsgi_app
    response = self.full_dispatch_request()
               │    └ <function Flask.full_dispatch_request at 0x7fa25c354310>
               └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 1950, in full_dispatch_request
    rv = self.dispatch_request()
         │    └ <function Flask.dispatch_request at 0x7fa25c354280>
         └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 1936, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
           │    │              │    │           │   └ {}
           │    │              │    │           └ <Request 'http://180.201.163.246:5000/update_cs' [POST]>
           │    │              │    └ 'update_content_spider'
           │    │              └ <Rule '/update_cs' (GET, HEAD, POST, OPTIONS) -> update_content_spider>
           │    └ {'static': <bound method _PackageBoundObject.send_static_file of <Flask 'app'>>, 'get_pro_info': <function get_pro_info at 0x...
           └ <Flask 'app'>

  File "/home/users/Scy/yuqing/spider/app.py", line 89, in update_content_spider
    errors.update({"rm": project.del_spider(rm_spiders)})
    │      │             │       │          └ '乌有之乡'
    │      │             │       └ <function Project.del_spider at 0x7fa1638bc0d0>
    │      │             └ <monitor.projectManager.Project object at 0x7fa1638c48e0>
    │      └ <method 'update' of 'dict' objects>
    └ {'add': defaultdict(<class 'dict'>, {})}

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 381, in del_spider
    self.update_device_valid(device)
    │    │                   └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    └ <function Project.update_device_valid at 0x7fa1638bc280>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 421, in update_device_valid
    self.database_manager.mysql.update(Device(**device.to_item()))
    │    │                │     │      │        │      └ <function DeviceC.to_item at 0x7fa252daa310>
    │    │                │     │      │        └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    │                │     │      └ <class 'base.db.mysql.Device'>
    │    │                │     └ <function Mysql.update at 0x7fa252eb1790>
    │    │                └ <base.db.mysql.Mysql object at 0x7fa1638b6f40>
    │    └ <base.db.dbSlot.Slot object at 0x7fa1638b6e80>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

> File "/home/users/Scy/yuqing/spider/base/db/mysql.py", line 375, in update
    row.update(new)
    │   │      └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '1388644135484522009473673397...
    │   └ <function Query.update at 0x7fa252ff03a0>
    └ <sqlalchemy.orm.query.Query object at 0x7fa160b3ac10>

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/query.py", line 3221, in update
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7fa252fccaf0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7fa160b3ae80>
             └ <sqlalchemy.orm.query.Query object at 0x7fa160b3ac10>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 1689, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa160381eb0>
             │    └ <function Connection._execute_20 at 0x7fa253279790>
             └ <sqlalchemy.engine.base.Connection object at 0x7fa160b3af40>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1583, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fa160b3af40>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa160381eb0>>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 323, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fa2532795e0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fa160b3af40>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1452, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fa2532798b0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fa160b3af40>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1814, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fa253279a60>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa160b3af40>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1995, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fa25363aa60>
    └ <module 'sqlalchemy.util' from '/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/__init__.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa160b3af40>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '1388644135484522009473673397...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa160381790>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='1388644135484522009473...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa160381790>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='1388644135484522009473...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa1608662e0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa1608662e0>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa1608662e0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa160b3a280>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa160b3a280>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa160b3a1c0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa160b3a1c0>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")
[SQL: UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, port=%(port)s, valid=%(valid)s WHERE device.ip = %(ip_1)s]
[parameters: {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '13886441354845220094736733975806507270969338158324027379489022996260613788180293030040952117736671674512821203103482990298882171321790694520322157418 ... (10 characters truncated) ... 98583843070281518404346239904963528664698615336148456095878603056629071878753788798721263348357121250606083690777414334064428398455184258440698080960', 'address': '/home/users/CT/pycharmproject/spiders/', 'port': 6800, 'valid': 1, 'ip_1': '180.201.163.246'}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-05-13 16:25:52.341 | ERROR    | base.db.mysql:update:390 - 【mysql更新数据出错】
Traceback (most recent call last):

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa161e495b0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '3315916050622742209191542255...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa160b00c70>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='3315916050622742209191...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa160b00c70>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='3315916050622742209191...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa1608662e0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa1608662e0>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa1608662e0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa161e49d00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa161e49d00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa161bca6d0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa161bca6d0>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

pymysql.err.IntegrityError: (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fa27b7e4a60>
    └ <Thread(Thread-551, started daemon 140330575054592)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fa27b7e4790>
    └ <Thread(Thread-551, started daemon 140330575054592)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-551, started daemon 140330575054592)>
    │    │        │    └ (<socket.socket fd=19, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), r...
    │    │        └ <Thread(Thread-551, started daemon 140330575054592)>
    │    └ <bound method ThreadingMixIn.process_request_thread of <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>>
    └ <Thread(Thread-551, started daemon 140330575054592)>
  File "/usr/lib/python3.8/socketserver.py", line 683, in process_request_thread
    self.finish_request(request, client_address)
    │    │              │        └ ('180.201.152.222', 60538)
    │    │              └ <socket.socket fd=19, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), ra...
    │    └ <function BaseServer.finish_request at 0x7fa26d121310>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
  File "/usr/lib/python3.8/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    │    │                   │        │               └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
    │    │                   │        └ ('180.201.152.222', 60538)
    │    │                   └ <socket.socket fd=19, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), ra...
    │    └ <class 'werkzeug.serving.WSGIRequestHandler'>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
  File "/usr/lib/python3.8/socketserver.py", line 747, in __init__
    self.handle()
    │    └ <function WSGIRequestHandler.handle at 0x7fa25c841e50>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa160aa4910>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 342, in handle
    BaseHTTPRequestHandler.handle(self)
    │                      │      └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa160aa4910>
    │                      └ <function BaseHTTPRequestHandler.handle at 0x7fa278793430>
    └ <class 'http.server.BaseHTTPRequestHandler'>

  File "/usr/lib/python3.8/http/server.py", line 427, in handle
    self.handle_one_request()
    │    └ <function WSGIRequestHandler.handle_one_request at 0x7fa25c846040>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa160aa4910>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 374, in handle_one_request
    self.run_wsgi()
    │    └ <function WSGIRequestHandler.run_wsgi at 0x7fa25c841dc0>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa160aa4910>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 319, in run_wsgi
    execute(self.server.app)
    │       │    │      └ <Flask 'app'>
    │       │    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
    │       └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa160aa4910>
    └ <function WSGIRequestHandler.run_wsgi.<locals>.execute at 0x7fa160828820>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 308, in execute
    application_iter = app(environ, start_response)
                       │   │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7fa160828670>
                       │   └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=19>, 'wsgi.errors': <_io.TextIOWra...
                       └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 2464, in __call__
    return self.wsgi_app(environ, start_response)
           │    │        │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7fa160828670>
           │    │        └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=19>, 'wsgi.errors': <_io.TextIOWra...
           │    └ <function Flask.wsgi_app at 0x7fa25c354c10>
           └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 2447, in wsgi_app
    response = self.full_dispatch_request()
               │    └ <function Flask.full_dispatch_request at 0x7fa25c354310>
               └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 1950, in full_dispatch_request
    rv = self.dispatch_request()
         │    └ <function Flask.dispatch_request at 0x7fa25c354280>
         └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 1936, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
           │    │              │    │           │   └ {}
           │    │              │    │           └ <Request 'http://180.201.163.246:5000/update_cs' [POST]>
           │    │              │    └ 'update_content_spider'
           │    │              └ <Rule '/update_cs' (GET, HEAD, POST, OPTIONS) -> update_content_spider>
           │    └ {'static': <bound method _PackageBoundObject.send_static_file of <Flask 'app'>>, 'get_pro_info': <function get_pro_info at 0x...
           └ <Flask 'app'>

  File "/home/users/Scy/yuqing/spider/app.py", line 89, in update_content_spider
    errors.update({"rm": project.del_spider(rm_spiders)})
    │      │             │       │          └ '人民日报'
    │      │             │       └ <function Project.del_spider at 0x7fa1638bc0d0>
    │      │             └ <monitor.projectManager.Project object at 0x7fa1638c48e0>
    │      └ <method 'update' of 'dict' objects>
    └ {'add': defaultdict(<class 'dict'>, {})}

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 381, in del_spider
    self.update_device_valid(device)
    │    │                   └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    └ <function Project.update_device_valid at 0x7fa1638bc280>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 421, in update_device_valid
    self.database_manager.mysql.update(Device(**device.to_item()))
    │    │                │     │      │        │      └ <function DeviceC.to_item at 0x7fa252daa310>
    │    │                │     │      │        └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    │                │     │      └ <class 'base.db.mysql.Device'>
    │    │                │     └ <function Mysql.update at 0x7fa252eb1790>
    │    │                └ <base.db.mysql.Mysql object at 0x7fa1638b6f40>
    │    └ <base.db.dbSlot.Slot object at 0x7fa1638b6e80>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

> File "/home/users/Scy/yuqing/spider/base/db/mysql.py", line 375, in update
    row.update(new)
    │   │      └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '3315916050622742209191542255...
    │   └ <function Query.update at 0x7fa252ff03a0>
    └ <sqlalchemy.orm.query.Query object at 0x7fa1608989d0>

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/query.py", line 3221, in update
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7fa252fccaf0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7fa160898580>
             └ <sqlalchemy.orm.query.Query object at 0x7fa1608989d0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 1689, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa160b00820>
             │    └ <function Connection._execute_20 at 0x7fa253279790>
             └ <sqlalchemy.engine.base.Connection object at 0x7fa161e495b0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1583, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fa161e495b0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa160b00820>>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 323, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fa2532795e0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fa161e495b0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1452, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fa2532798b0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fa161e495b0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1814, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fa253279a60>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa161e495b0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1995, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fa25363aa60>
    └ <module 'sqlalchemy.util' from '/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/__init__.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa161e495b0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '3315916050622742209191542255...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa160b00c70>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='3315916050622742209191...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa160b00c70>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='3315916050622742209191...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa1608662e0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa1608662e0>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa1608662e0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa161e49d00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa161e49d00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa161bca6d0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa161bca6d0>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")
[SQL: UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, port=%(port)s, valid=%(valid)s WHERE device.ip = %(ip_1)s]
[parameters: {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '33159160506227422091915422552484744500491788650124342622949497437581916725180641864452428749741884718346855836165572340077690452757843153410309810731 ... (9 characters truncated) ... 08459040193561804701264945159253490082400875902742577529332791558389711995265918159179866925755195179749428336334164017226408386696140119896279579458', 'address': '/home/users/CT/pycharmproject/spiders/', 'port': 6800, 'valid': 1, 'ip_1': '180.201.163.246'}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-05-13 16:25:53.925 | ERROR    | base.db.mysql:update:390 - 【mysql更新数据出错】
Traceback (most recent call last):

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa162edcbe0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '3147454338325731536610236690...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa1603fbcd0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='3147454338325731536610...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa1603fbcd0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='3147454338325731536610...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa161c838b0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa161c838b0>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa161c838b0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa1603fb2b0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa1603fb2b0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa1603fbe80>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa1603fbe80>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

pymysql.err.IntegrityError: (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fa27b7e4a60>
    └ <Thread(Thread-552, started daemon 140330575054592)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fa27b7e4790>
    └ <Thread(Thread-552, started daemon 140330575054592)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-552, started daemon 140330575054592)>
    │    │        │    └ (<socket.socket fd=22, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), r...
    │    │        └ <Thread(Thread-552, started daemon 140330575054592)>
    │    └ <bound method ThreadingMixIn.process_request_thread of <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>>
    └ <Thread(Thread-552, started daemon 140330575054592)>
  File "/usr/lib/python3.8/socketserver.py", line 683, in process_request_thread
    self.finish_request(request, client_address)
    │    │              │        └ ('180.201.152.222', 60541)
    │    │              └ <socket.socket fd=22, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), ra...
    │    └ <function BaseServer.finish_request at 0x7fa26d121310>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
  File "/usr/lib/python3.8/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    │    │                   │        │               └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
    │    │                   │        └ ('180.201.152.222', 60541)
    │    │                   └ <socket.socket fd=22, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), ra...
    │    └ <class 'werkzeug.serving.WSGIRequestHandler'>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
  File "/usr/lib/python3.8/socketserver.py", line 747, in __init__
    self.handle()
    │    └ <function WSGIRequestHandler.handle at 0x7fa25c841e50>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa161e0f190>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 342, in handle
    BaseHTTPRequestHandler.handle(self)
    │                      │      └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa161e0f190>
    │                      └ <function BaseHTTPRequestHandler.handle at 0x7fa278793430>
    └ <class 'http.server.BaseHTTPRequestHandler'>

  File "/usr/lib/python3.8/http/server.py", line 427, in handle
    self.handle_one_request()
    │    └ <function WSGIRequestHandler.handle_one_request at 0x7fa25c846040>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa161e0f190>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 374, in handle_one_request
    self.run_wsgi()
    │    └ <function WSGIRequestHandler.run_wsgi at 0x7fa25c841dc0>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa161e0f190>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 319, in run_wsgi
    execute(self.server.app)
    │       │    │      └ <Flask 'app'>
    │       │    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
    │       └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa161e0f190>
    └ <function WSGIRequestHandler.run_wsgi.<locals>.execute at 0x7fa16081d310>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 308, in execute
    application_iter = app(environ, start_response)
                       │   │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7fa16081d940>
                       │   └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=22>, 'wsgi.errors': <_io.TextIOWra...
                       └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 2464, in __call__
    return self.wsgi_app(environ, start_response)
           │    │        │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7fa16081d940>
           │    │        └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=22>, 'wsgi.errors': <_io.TextIOWra...
           │    └ <function Flask.wsgi_app at 0x7fa25c354c10>
           └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 2447, in wsgi_app
    response = self.full_dispatch_request()
               │    └ <function Flask.full_dispatch_request at 0x7fa25c354310>
               └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 1950, in full_dispatch_request
    rv = self.dispatch_request()
         │    └ <function Flask.dispatch_request at 0x7fa25c354280>
         └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 1936, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
           │    │              │    │           │   └ {}
           │    │              │    │           └ <Request 'http://180.201.163.246:5000/update_cs' [POST]>
           │    │              │    └ 'update_content_spider'
           │    │              └ <Rule '/update_cs' (GET, HEAD, POST, OPTIONS) -> update_content_spider>
           │    └ {'static': <bound method _PackageBoundObject.send_static_file of <Flask 'app'>>, 'get_pro_info': <function get_pro_info at 0x...
           └ <Flask 'app'>

  File "/home/users/Scy/yuqing/spider/app.py", line 89, in update_content_spider
    errors.update({"rm": project.del_spider(rm_spiders)})
    │      │             │       │          └ '人民网'
    │      │             │       └ <function Project.del_spider at 0x7fa1638bc0d0>
    │      │             └ <monitor.projectManager.Project object at 0x7fa1638c48e0>
    │      └ <method 'update' of 'dict' objects>
    └ {'add': defaultdict(<class 'dict'>, {})}

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 381, in del_spider
    self.update_device_valid(device)
    │    │                   └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    └ <function Project.update_device_valid at 0x7fa1638bc280>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 421, in update_device_valid
    self.database_manager.mysql.update(Device(**device.to_item()))
    │    │                │     │      │        │      └ <function DeviceC.to_item at 0x7fa252daa310>
    │    │                │     │      │        └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    │                │     │      └ <class 'base.db.mysql.Device'>
    │    │                │     └ <function Mysql.update at 0x7fa252eb1790>
    │    │                └ <base.db.mysql.Mysql object at 0x7fa1638b6f40>
    │    └ <base.db.dbSlot.Slot object at 0x7fa1638b6e80>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

> File "/home/users/Scy/yuqing/spider/base/db/mysql.py", line 375, in update
    row.update(new)
    │   │      └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '3147454338325731536610236690...
    │   └ <function Query.update at 0x7fa252ff03a0>
    └ <sqlalchemy.orm.query.Query object at 0x7fa162eb8af0>

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/query.py", line 3221, in update
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7fa252fccaf0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7fa162eb8c40>
             └ <sqlalchemy.orm.query.Query object at 0x7fa162eb8af0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 1689, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa1603fbc10>
             │    └ <function Connection._execute_20 at 0x7fa253279790>
             └ <sqlalchemy.engine.base.Connection object at 0x7fa162edcbe0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1583, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fa162edcbe0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa1603fbc10>>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 323, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fa2532795e0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fa162edcbe0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1452, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fa2532798b0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fa162edcbe0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1814, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fa253279a60>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa162edcbe0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1995, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fa25363aa60>
    └ <module 'sqlalchemy.util' from '/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/__init__.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa162edcbe0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '3147454338325731536610236690...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa1603fbcd0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='3147454338325731536610...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa1603fbcd0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='3147454338325731536610...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa161c838b0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa161c838b0>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa161c838b0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa1603fb2b0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa1603fb2b0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa1603fbe80>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa1603fbe80>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")
[SQL: UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, port=%(port)s, valid=%(valid)s WHERE device.ip = %(ip_1)s]
[parameters: {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '31474543383257315366102366909344131016877451988292723884303006013103236353385634093975051795380023697114247688290233319135704831987442241900389719890 ... (10 characters truncated) ... 77711531776134117214899055611960640612909785399570173201458070703450797996079032668870152862585866911040605114269575894197564567032182495351474119295', 'address': '/home/users/CT/pycharmproject/spiders/', 'port': 6800, 'valid': 1, 'ip_1': '180.201.163.246'}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-05-13 16:25:55.750 | ERROR    | base.db.mysql:update:390 - 【mysql更新数据出错】
Traceback (most recent call last):

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa161daa4f0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '7787442796019765641245041205...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa1603fb820>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='7787442796019765641245...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa1603fb820>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='7787442796019765641245...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa161daa0a0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa161daa0a0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa161daa940>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa161daa940>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

pymysql.err.IntegrityError: (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fa27b7e4a60>
    └ <Thread(Thread-554, started daemon 140330575054592)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fa27b7e4790>
    └ <Thread(Thread-554, started daemon 140330575054592)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-554, started daemon 140330575054592)>
    │    │        │    └ (<socket.socket fd=19, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), r...
    │    │        └ <Thread(Thread-554, started daemon 140330575054592)>
    │    └ <bound method ThreadingMixIn.process_request_thread of <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>>
    └ <Thread(Thread-554, started daemon 140330575054592)>
  File "/usr/lib/python3.8/socketserver.py", line 683, in process_request_thread
    self.finish_request(request, client_address)
    │    │              │        └ ('180.201.152.222', 60543)
    │    │              └ <socket.socket fd=19, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), ra...
    │    └ <function BaseServer.finish_request at 0x7fa26d121310>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
  File "/usr/lib/python3.8/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    │    │                   │        │               └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
    │    │                   │        └ ('180.201.152.222', 60543)
    │    │                   └ <socket.socket fd=19, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), ra...
    │    └ <class 'werkzeug.serving.WSGIRequestHandler'>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
  File "/usr/lib/python3.8/socketserver.py", line 747, in __init__
    self.handle()
    │    └ <function WSGIRequestHandler.handle at 0x7fa25c841e50>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa16382be20>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 342, in handle
    BaseHTTPRequestHandler.handle(self)
    │                      │      └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa16382be20>
    │                      └ <function BaseHTTPRequestHandler.handle at 0x7fa278793430>
    └ <class 'http.server.BaseHTTPRequestHandler'>

  File "/usr/lib/python3.8/http/server.py", line 427, in handle
    self.handle_one_request()
    │    └ <function WSGIRequestHandler.handle_one_request at 0x7fa25c846040>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa16382be20>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 374, in handle_one_request
    self.run_wsgi()
    │    └ <function WSGIRequestHandler.run_wsgi at 0x7fa25c841dc0>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa16382be20>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 319, in run_wsgi
    execute(self.server.app)
    │       │    │      └ <Flask 'app'>
    │       │    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
    │       └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa16382be20>
    └ <function WSGIRequestHandler.run_wsgi.<locals>.execute at 0x7fa161c893a0>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 308, in execute
    application_iter = app(environ, start_response)
                       │   │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7fa161ccedc0>
                       │   └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=19>, 'wsgi.errors': <_io.TextIOWra...
                       └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 2464, in __call__
    return self.wsgi_app(environ, start_response)
           │    │        │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7fa161ccedc0>
           │    │        └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=19>, 'wsgi.errors': <_io.TextIOWra...
           │    └ <function Flask.wsgi_app at 0x7fa25c354c10>
           └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 2447, in wsgi_app
    response = self.full_dispatch_request()
               │    └ <function Flask.full_dispatch_request at 0x7fa25c354310>
               └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 1950, in full_dispatch_request
    rv = self.dispatch_request()
         │    └ <function Flask.dispatch_request at 0x7fa25c354280>
         └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 1936, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
           │    │              │    │           │   └ {}
           │    │              │    │           └ <Request 'http://180.201.163.246:5000/update_cs' [POST]>
           │    │              │    └ 'update_content_spider'
           │    │              └ <Rule '/update_cs' (GET, HEAD, POST, OPTIONS) -> update_content_spider>
           │    └ {'static': <bound method _PackageBoundObject.send_static_file of <Flask 'app'>>, 'get_pro_info': <function get_pro_info at 0x...
           └ <Flask 'app'>

  File "/home/users/Scy/yuqing/spider/app.py", line 89, in update_content_spider
    errors.update({"rm": project.del_spider(rm_spiders)})
    │      │             │       │          └ '凤凰网'
    │      │             │       └ <function Project.del_spider at 0x7fa1638bc0d0>
    │      │             └ <monitor.projectManager.Project object at 0x7fa1638c48e0>
    │      └ <method 'update' of 'dict' objects>
    └ {'add': defaultdict(<class 'dict'>, {})}

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 381, in del_spider
    self.update_device_valid(device)
    │    │                   └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    └ <function Project.update_device_valid at 0x7fa1638bc280>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 421, in update_device_valid
    self.database_manager.mysql.update(Device(**device.to_item()))
    │    │                │     │      │        │      └ <function DeviceC.to_item at 0x7fa252daa310>
    │    │                │     │      │        └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    │                │     │      └ <class 'base.db.mysql.Device'>
    │    │                │     └ <function Mysql.update at 0x7fa252eb1790>
    │    │                └ <base.db.mysql.Mysql object at 0x7fa1638b6f40>
    │    └ <base.db.dbSlot.Slot object at 0x7fa1638b6e80>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

> File "/home/users/Scy/yuqing/spider/base/db/mysql.py", line 375, in update
    row.update(new)
    │   │      └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '7787442796019765641245041205...
    │   └ <function Query.update at 0x7fa252ff03a0>
    └ <sqlalchemy.orm.query.Query object at 0x7fa161bca160>

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/query.py", line 3221, in update
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7fa252fccaf0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7fa161bcaf70>
             └ <sqlalchemy.orm.query.Query object at 0x7fa161bca160>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 1689, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa1603fb040>
             │    └ <function Connection._execute_20 at 0x7fa253279790>
             └ <sqlalchemy.engine.base.Connection object at 0x7fa161daa4f0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1583, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fa161daa4f0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa1603fb040>>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 323, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fa2532795e0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fa161daa4f0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1452, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fa2532798b0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fa161daa4f0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1814, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fa253279a60>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa161daa4f0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1995, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fa25363aa60>
    └ <module 'sqlalchemy.util' from '/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/__init__.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa161daa4f0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '7787442796019765641245041205...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa1603fb820>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='7787442796019765641245...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa1603fb820>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='7787442796019765641245...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa1638c4d00>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa161daa0a0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa161daa0a0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa161daa940>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa161daa940>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")
[SQL: UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, port=%(port)s, valid=%(valid)s WHERE device.ip = %(ip_1)s]
[parameters: {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '77874427960197656412450412055289302438265390932234495200506874807514256248613986889863521978015478559660219064128699079164845385658205587035629569844 ... (10 characters truncated) ... 24172358800219476621817025723033388712491339062340705975346609516020121958081456893437553611938057790016933878095395905786984051703148281764367641276', 'address': '/home/users/CT/pycharmproject/spiders/', 'port': 6800, 'valid': 1, 'ip_1': '180.201.163.246'}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-05-13 16:25:57.584 | ERROR    | base.db.mysql:update:390 - 【mysql更新数据出错】
Traceback (most recent call last):

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa1609a3460>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '2253563898917421525531381700...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa1609a39a0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='2253563898917421525531...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa1609a39a0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='2253563898917421525531...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa1608662e0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa1608662e0>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa1608662e0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa1609a3250>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa1609a3250>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa1609a3880>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa1609a3880>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

pymysql.err.IntegrityError: (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fa27b7e4a60>
    └ <Thread(Thread-555, started daemon 140330575054592)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fa27b7e4790>
    └ <Thread(Thread-555, started daemon 140330575054592)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-555, started daemon 140330575054592)>
    │    │        │    └ (<socket.socket fd=21, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), r...
    │    │        └ <Thread(Thread-555, started daemon 140330575054592)>
    │    └ <bound method ThreadingMixIn.process_request_thread of <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>>
    └ <Thread(Thread-555, started daemon 140330575054592)>
  File "/usr/lib/python3.8/socketserver.py", line 683, in process_request_thread
    self.finish_request(request, client_address)
    │    │              │        └ ('180.201.152.222', 60544)
    │    │              └ <socket.socket fd=21, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), ra...
    │    └ <function BaseServer.finish_request at 0x7fa26d121310>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
  File "/usr/lib/python3.8/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    │    │                   │        │               └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
    │    │                   │        └ ('180.201.152.222', 60544)
    │    │                   └ <socket.socket fd=21, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), ra...
    │    └ <class 'werkzeug.serving.WSGIRequestHandler'>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
  File "/usr/lib/python3.8/socketserver.py", line 747, in __init__
    self.handle()
    │    └ <function WSGIRequestHandler.handle at 0x7fa25c841e50>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa16074e070>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 342, in handle
    BaseHTTPRequestHandler.handle(self)
    │                      │      └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa16074e070>
    │                      └ <function BaseHTTPRequestHandler.handle at 0x7fa278793430>
    └ <class 'http.server.BaseHTTPRequestHandler'>

  File "/usr/lib/python3.8/http/server.py", line 427, in handle
    self.handle_one_request()
    │    └ <function WSGIRequestHandler.handle_one_request at 0x7fa25c846040>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa16074e070>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 374, in handle_one_request
    self.run_wsgi()
    │    └ <function WSGIRequestHandler.run_wsgi at 0x7fa25c841dc0>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa16074e070>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 319, in run_wsgi
    execute(self.server.app)
    │       │    │      └ <Flask 'app'>
    │       │    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
    │       └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa16074e070>
    └ <function WSGIRequestHandler.run_wsgi.<locals>.execute at 0x7fa160992d30>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 308, in execute
    application_iter = app(environ, start_response)
                       │   │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7fa161d28af0>
                       │   └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=21>, 'wsgi.errors': <_io.TextIOWra...
                       └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 2464, in __call__
    return self.wsgi_app(environ, start_response)
           │    │        │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7fa161d28af0>
           │    │        └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=21>, 'wsgi.errors': <_io.TextIOWra...
           │    └ <function Flask.wsgi_app at 0x7fa25c354c10>
           └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 2447, in wsgi_app
    response = self.full_dispatch_request()
               │    └ <function Flask.full_dispatch_request at 0x7fa25c354310>
               └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 1950, in full_dispatch_request
    rv = self.dispatch_request()
         │    └ <function Flask.dispatch_request at 0x7fa25c354280>
         └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 1936, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
           │    │              │    │           │   └ {}
           │    │              │    │           └ <Request 'http://180.201.163.246:5000/update_cs' [POST]>
           │    │              │    └ 'update_content_spider'
           │    │              └ <Rule '/update_cs' (GET, HEAD, POST, OPTIONS) -> update_content_spider>
           │    └ {'static': <bound method _PackageBoundObject.send_static_file of <Flask 'app'>>, 'get_pro_info': <function get_pro_info at 0x...
           └ <Flask 'app'>

  File "/home/users/Scy/yuqing/spider/app.py", line 89, in update_content_spider
    errors.update({"rm": project.del_spider(rm_spiders)})
    │      │             │       │          └ '复兴网'
    │      │             │       └ <function Project.del_spider at 0x7fa1638bc0d0>
    │      │             └ <monitor.projectManager.Project object at 0x7fa1638c48e0>
    │      └ <method 'update' of 'dict' objects>
    └ {'add': defaultdict(<class 'dict'>, {})}

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 381, in del_spider
    self.update_device_valid(device)
    │    │                   └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    └ <function Project.update_device_valid at 0x7fa1638bc280>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 421, in update_device_valid
    self.database_manager.mysql.update(Device(**device.to_item()))
    │    │                │     │      │        │      └ <function DeviceC.to_item at 0x7fa252daa310>
    │    │                │     │      │        └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    │                │     │      └ <class 'base.db.mysql.Device'>
    │    │                │     └ <function Mysql.update at 0x7fa252eb1790>
    │    │                └ <base.db.mysql.Mysql object at 0x7fa1638b6f40>
    │    └ <base.db.dbSlot.Slot object at 0x7fa1638b6e80>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

> File "/home/users/Scy/yuqing/spider/base/db/mysql.py", line 375, in update
    row.update(new)
    │   │      └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '2253563898917421525531381700...
    │   └ <function Query.update at 0x7fa252ff03a0>
    └ <sqlalchemy.orm.query.Query object at 0x7fa1609a3af0>

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/query.py", line 3221, in update
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7fa252fccaf0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7fa16074e820>
             └ <sqlalchemy.orm.query.Query object at 0x7fa1609a3af0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 1689, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa1609a3e80>
             │    └ <function Connection._execute_20 at 0x7fa253279790>
             └ <sqlalchemy.engine.base.Connection object at 0x7fa1609a3460>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1583, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fa1609a3460>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa1609a3e80>>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 323, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fa2532795e0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fa1609a3460>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1452, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fa2532798b0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fa1609a3460>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1814, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fa253279a60>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa1609a3460>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1995, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fa25363aa60>
    └ <module 'sqlalchemy.util' from '/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/__init__.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa1609a3460>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '2253563898917421525531381700...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa1609a39a0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='2253563898917421525531...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa1609a39a0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='2253563898917421525531...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa1608662e0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa1608662e0>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa1608662e0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa1609a3250>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa1609a3250>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa1609a3880>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa1609a3880>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")
[SQL: UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, port=%(port)s, valid=%(valid)s WHERE device.ip = %(ip_1)s]
[parameters: {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '22535638989174215255313817002328331545917927912855050341475209757700730037013609846574640655355615524727807236206565646290272397043828420971620311282 ... (10 characters truncated) ... 01358039596247344264445399124998376372726202793357446753006284269399389382027870899306438241198883145247644191659316499202780200563654689703251091671', 'address': '/home/users/CT/pycharmproject/spiders/', 'port': 6800, 'valid': 1, 'ip_1': '180.201.163.246'}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-05-13 16:25:59.460 | ERROR    | base.db.mysql:update:390 - 【mysql更新数据出错】
Traceback (most recent call last):

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa160b1b0d0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '6133417780687095440483009019...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa160b1b400>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='6133417780687095440483...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa160b1b400>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='6133417780687095440483...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa16097d700>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa16097d700>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa16097d700>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa160b1bac0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa160b1bac0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa161be73a0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa161be73a0>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

pymysql.err.IntegrityError: (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fa27b7e4a60>
    └ <Thread(Thread-556, started daemon 140330575054592)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fa27b7e4790>
    └ <Thread(Thread-556, started daemon 140330575054592)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-556, started daemon 140330575054592)>
    │    │        │    └ (<socket.socket fd=22, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), r...
    │    │        └ <Thread(Thread-556, started daemon 140330575054592)>
    │    └ <bound method ThreadingMixIn.process_request_thread of <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>>
    └ <Thread(Thread-556, started daemon 140330575054592)>
  File "/usr/lib/python3.8/socketserver.py", line 683, in process_request_thread
    self.finish_request(request, client_address)
    │    │              │        └ ('180.201.152.222', 60545)
    │    │              └ <socket.socket fd=22, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), ra...
    │    └ <function BaseServer.finish_request at 0x7fa26d121310>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
  File "/usr/lib/python3.8/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    │    │                   │        │               └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
    │    │                   │        └ ('180.201.152.222', 60545)
    │    │                   └ <socket.socket fd=22, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), ra...
    │    └ <class 'werkzeug.serving.WSGIRequestHandler'>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
  File "/usr/lib/python3.8/socketserver.py", line 747, in __init__
    self.handle()
    │    └ <function WSGIRequestHandler.handle at 0x7fa25c841e50>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa161be7490>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 342, in handle
    BaseHTTPRequestHandler.handle(self)
    │                      │      └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa161be7490>
    │                      └ <function BaseHTTPRequestHandler.handle at 0x7fa278793430>
    └ <class 'http.server.BaseHTTPRequestHandler'>

  File "/usr/lib/python3.8/http/server.py", line 427, in handle
    self.handle_one_request()
    │    └ <function WSGIRequestHandler.handle_one_request at 0x7fa25c846040>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa161be7490>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 374, in handle_one_request
    self.run_wsgi()
    │    └ <function WSGIRequestHandler.run_wsgi at 0x7fa25c841dc0>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa161be7490>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 319, in run_wsgi
    execute(self.server.app)
    │       │    │      └ <Flask 'app'>
    │       │    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
    │       └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa161be7490>
    └ <function WSGIRequestHandler.run_wsgi.<locals>.execute at 0x7fa1602ec790>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 308, in execute
    application_iter = app(environ, start_response)
                       │   │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7fa1602ec670>
                       │   └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=22>, 'wsgi.errors': <_io.TextIOWra...
                       └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 2464, in __call__
    return self.wsgi_app(environ, start_response)
           │    │        │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7fa1602ec670>
           │    │        └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=22>, 'wsgi.errors': <_io.TextIOWra...
           │    └ <function Flask.wsgi_app at 0x7fa25c354c10>
           └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 2447, in wsgi_app
    response = self.full_dispatch_request()
               │    └ <function Flask.full_dispatch_request at 0x7fa25c354310>
               └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 1950, in full_dispatch_request
    rv = self.dispatch_request()
         │    └ <function Flask.dispatch_request at 0x7fa25c354280>
         └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 1936, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
           │    │              │    │           │   └ {}
           │    │              │    │           └ <Request 'http://180.201.163.246:5000/update_cs' [POST]>
           │    │              │    └ 'update_content_spider'
           │    │              └ <Rule '/update_cs' (GET, HEAD, POST, OPTIONS) -> update_content_spider>
           │    └ {'static': <bound method _PackageBoundObject.send_static_file of <Flask 'app'>>, 'get_pro_info': <function get_pro_info at 0x...
           └ <Flask 'app'>

  File "/home/users/Scy/yuqing/spider/app.py", line 89, in update_content_spider
    errors.update({"rm": project.del_spider(rm_spiders)})
    │      │             │       │          └ '强国论坛'
    │      │             │       └ <function Project.del_spider at 0x7fa1638bc0d0>
    │      │             └ <monitor.projectManager.Project object at 0x7fa1638c48e0>
    │      └ <method 'update' of 'dict' objects>
    └ {'add': defaultdict(<class 'dict'>, {})}

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 381, in del_spider
    self.update_device_valid(device)
    │    │                   └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    └ <function Project.update_device_valid at 0x7fa1638bc280>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 421, in update_device_valid
    self.database_manager.mysql.update(Device(**device.to_item()))
    │    │                │     │      │        │      └ <function DeviceC.to_item at 0x7fa252daa310>
    │    │                │     │      │        └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    │                │     │      └ <class 'base.db.mysql.Device'>
    │    │                │     └ <function Mysql.update at 0x7fa252eb1790>
    │    │                └ <base.db.mysql.Mysql object at 0x7fa1638b6f40>
    │    └ <base.db.dbSlot.Slot object at 0x7fa1638b6e80>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

> File "/home/users/Scy/yuqing/spider/base/db/mysql.py", line 375, in update
    row.update(new)
    │   │      └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '6133417780687095440483009019...
    │   └ <function Query.update at 0x7fa252ff03a0>
    └ <sqlalchemy.orm.query.Query object at 0x7fa160b1bbb0>

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/query.py", line 3221, in update
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7fa252fccaf0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7fa160b1b460>
             └ <sqlalchemy.orm.query.Query object at 0x7fa160b1bbb0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 1689, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa160b1b160>
             │    └ <function Connection._execute_20 at 0x7fa253279790>
             └ <sqlalchemy.engine.base.Connection object at 0x7fa160b1b0d0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1583, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fa160b1b0d0>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa160b1b160>>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 323, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fa2532795e0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fa160b1b0d0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1452, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fa2532798b0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fa160b1b0d0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1814, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fa253279a60>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa160b1b0d0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1995, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fa25363aa60>
    └ <module 'sqlalchemy.util' from '/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/__init__.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa160b1b0d0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '6133417780687095440483009019...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa160b1b400>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='6133417780687095440483...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa160b1b400>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='6133417780687095440483...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa16097d700>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa16097d700>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa16097d700>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa160b1bac0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa160b1bac0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa161be73a0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa161be73a0>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")
[SQL: UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, port=%(port)s, valid=%(valid)s WHERE device.ip = %(ip_1)s]
[parameters: {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '61334177806870954404830090196508572910038224645788943949826657054718442074921103735491967977567544296025572479143047369084016150245329958875252382626 ... (10 characters truncated) ... 74899533726122837151457798373009320503180857480822819730134235864200041328885988160687181489790427200112772988250434538987414057995446155291016749749', 'address': '/home/users/CT/pycharmproject/spiders/', 'port': 6800, 'valid': 1, 'ip_1': '180.201.163.246'}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2022-05-13 16:26:01.252 | ERROR    | base.db.mysql:update:390 - 【mysql更新数据出错】
Traceback (most recent call last):

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa161dcd670>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '7274202952088437266922609354...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa162ed1580>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='7274202952088437266922...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa162ed1580>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='7274202952088437266922...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa161c838b0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa161c838b0>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa161c838b0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa162ed1d90>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa162ed1d90>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa162ed1040>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa162ed1040>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

pymysql.err.IntegrityError: (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/usr/lib/python3.8/threading.py", line 890, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x7fa27b7e4a60>
    └ <Thread(Thread-559, started daemon 140330575054592)>
  File "/usr/lib/python3.8/threading.py", line 932, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x7fa27b7e4790>
    └ <Thread(Thread-559, started daemon 140330575054592)>
  File "/usr/lib/python3.8/threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(Thread-559, started daemon 140330575054592)>
    │    │        │    └ (<socket.socket fd=22, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), r...
    │    │        └ <Thread(Thread-559, started daemon 140330575054592)>
    │    └ <bound method ThreadingMixIn.process_request_thread of <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>>
    └ <Thread(Thread-559, started daemon 140330575054592)>
  File "/usr/lib/python3.8/socketserver.py", line 683, in process_request_thread
    self.finish_request(request, client_address)
    │    │              │        └ ('180.201.152.222', 60548)
    │    │              └ <socket.socket fd=22, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), ra...
    │    └ <function BaseServer.finish_request at 0x7fa26d121310>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
  File "/usr/lib/python3.8/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
    │    │                   │        │               └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
    │    │                   │        └ ('180.201.152.222', 60548)
    │    │                   └ <socket.socket fd=22, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('180.201.163.246', 5000), ra...
    │    └ <class 'werkzeug.serving.WSGIRequestHandler'>
    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
  File "/usr/lib/python3.8/socketserver.py", line 747, in __init__
    self.handle()
    │    └ <function WSGIRequestHandler.handle at 0x7fa25c841e50>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa161dcd3d0>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 342, in handle
    BaseHTTPRequestHandler.handle(self)
    │                      │      └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa161dcd3d0>
    │                      └ <function BaseHTTPRequestHandler.handle at 0x7fa278793430>
    └ <class 'http.server.BaseHTTPRequestHandler'>

  File "/usr/lib/python3.8/http/server.py", line 427, in handle
    self.handle_one_request()
    │    └ <function WSGIRequestHandler.handle_one_request at 0x7fa25c846040>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa161dcd3d0>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 374, in handle_one_request
    self.run_wsgi()
    │    └ <function WSGIRequestHandler.run_wsgi at 0x7fa25c841dc0>
    └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa161dcd3d0>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 319, in run_wsgi
    execute(self.server.app)
    │       │    │      └ <Flask 'app'>
    │       │    └ <werkzeug.serving.ThreadedWSGIServer object at 0x7fa163794250>
    │       └ <werkzeug.serving.WSGIRequestHandler object at 0x7fa161dcd3d0>
    └ <function WSGIRequestHandler.run_wsgi.<locals>.execute at 0x7fa160b46e50>

  File "/usr/local/lib/python3.8/dist-packages/werkzeug/serving.py", line 308, in execute
    application_iter = app(environ, start_response)
                       │   │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7fa161d048b0>
                       │   └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=22>, 'wsgi.errors': <_io.TextIOWra...
                       └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 2464, in __call__
    return self.wsgi_app(environ, start_response)
           │    │        │        └ <function WSGIRequestHandler.run_wsgi.<locals>.start_response at 0x7fa161d048b0>
           │    │        └ {'wsgi.version': (1, 0), 'wsgi.url_scheme': 'http', 'wsgi.input': <_io.BufferedReader name=22>, 'wsgi.errors': <_io.TextIOWra...
           │    └ <function Flask.wsgi_app at 0x7fa25c354c10>
           └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 2447, in wsgi_app
    response = self.full_dispatch_request()
               │    └ <function Flask.full_dispatch_request at 0x7fa25c354310>
               └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 1950, in full_dispatch_request
    rv = self.dispatch_request()
         │    └ <function Flask.dispatch_request at 0x7fa25c354280>
         └ <Flask 'app'>

  File "/usr/local/lib/python3.8/dist-packages/flask/app.py", line 1936, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
           │    │              │    │           │   └ {}
           │    │              │    │           └ <Request 'http://180.201.163.246:5000/update_cs' [POST]>
           │    │              │    └ 'update_content_spider'
           │    │              └ <Rule '/update_cs' (GET, HEAD, POST, OPTIONS) -> update_content_spider>
           │    └ {'static': <bound method _PackageBoundObject.send_static_file of <Flask 'app'>>, 'get_pro_info': <function get_pro_info at 0x...
           └ <Flask 'app'>

  File "/home/users/Scy/yuqing/spider/app.py", line 89, in update_content_spider
    errors.update({"rm": project.del_spider(rm_spiders)})
    │      │             │       │          └ '微信'
    │      │             │       └ <function Project.del_spider at 0x7fa1638bc0d0>
    │      │             └ <monitor.projectManager.Project object at 0x7fa1638c48e0>
    │      └ <method 'update' of 'dict' objects>
    └ {'add': defaultdict(<class 'dict'>, {})}

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 381, in del_spider
    self.update_device_valid(device)
    │    │                   └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    └ <function Project.update_device_valid at 0x7fa1638bc280>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

  File "/home/users/Scy/yuqing/spider/monitor/projectManager.py", line 421, in update_device_valid
    self.database_manager.mysql.update(Device(**device.to_item()))
    │    │                │     │      │        │      └ <function DeviceC.to_item at 0x7fa252daa310>
    │    │                │     │      │        └ <monitor.deviceManager.DeviceC object at 0x7fa1638c4730>
    │    │                │     │      └ <class 'base.db.mysql.Device'>
    │    │                │     └ <function Mysql.update at 0x7fa252eb1790>
    │    │                └ <base.db.mysql.Mysql object at 0x7fa1638b6f40>
    │    └ <base.db.dbSlot.Slot object at 0x7fa1638b6e80>
    └ <monitor.projectManager.Project object at 0x7fa1638c48e0>

> File "/home/users/Scy/yuqing/spider/base/db/mysql.py", line 375, in update
    row.update(new)
    │   │      └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '7274202952088437266922609354...
    │   └ <function Query.update at 0x7fa252ff03a0>
    └ <sqlalchemy.orm.query.Query object at 0x7fa161dcd4c0>

  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/query.py", line 3221, in update
    result = self.session.execute(
             │    │       └ <function Session.execute at 0x7fa252fccaf0>
             │    └ <sqlalchemy.orm.session.Session object at 0x7fa161dcd280>
             └ <sqlalchemy.orm.query.Query object at 0x7fa161dcd4c0>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/orm/session.py", line 1689, in execute
    result = conn._execute_20(statement, params or {}, execution_options)
             │    │           │          │             └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
             │    │           │          └ immutabledict({})
             │    │           └ <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa162ed1310>
             │    └ <function Connection._execute_20 at 0x7fa253279790>
             └ <sqlalchemy.engine.base.Connection object at 0x7fa161dcd670>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1583, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
           │    │     │             │               └ immutabledict({'synchronize_session': 'evaluate', '_sa_orm_update_options': default_update_options(_matched_objects=[], _reso...
           │    │     │             └ immutabledict({})
           │    │     └ ({},)
           │    └ <sqlalchemy.engine.base.Connection object at 0x7fa161dcd670>
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.annotation.AnnotatedUpdate object at 0x7fa162ed1310>>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 323, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x7fa2532795e0>
           └ <sqlalchemy.engine.base.Connection object at 0x7fa161dcd670>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1452, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x7fa2532798b0>
          └ <sqlalchemy.engine.base.Connection object at 0x7fa161dcd670>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1814, in _execute_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x7fa253279a60>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa161dcd670>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1995, in _handle_dbapi_exception
    util.raise_(
    │    └ <function raise_ at 0x7fa25363aa60>
    └ <module 'sqlalchemy.util' from '/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/__init__.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 207, in raise_
    raise exception
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1771, in _execute_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x7fa2531b45e0>
    │    └ <sqlalchemy.dialects.mysql.pymysql.MySQLDialect_pymysql object at 0x7fa1638b6d90>
    └ <sqlalchemy.engine.base.Connection object at 0x7fa161dcd670>
  File "/home/chase/.local/lib/python3.8/site-packages/sqlalchemy/engine/default.py", line 717, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '7274202952088437266922609354...
    │      │       └ 'UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, por...
    │      └ <function Cursor.execute at 0x7fa252e09dc0>
    └ <pymysql.cursors.Cursor object at 0x7fa162ed1580>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 148, in execute
    result = self._query(query)
             │    │      └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='7274202952088437266922...
             │    └ <function Cursor._query at 0x7fa252d94280>
             └ <pymysql.cursors.Cursor object at 0x7fa162ed1580>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/cursors.py", line 310, in _query
    conn.query(q)
    │    │     └ "UPDATE device SET server_id='180.201.163.246:6800', ip='180.201.163.246', username='chase', password='7274202952088437266922...
    │    └ <function Connection.query at 0x7fa252da2670>
    └ <pymysql.connections.Connection object at 0x7fa161c838b0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
    │    │                │    │                             └ False
    │    │                │    └ <function Connection._read_query_result at 0x7fa252da2ca0>
    │    │                └ <pymysql.connections.Connection object at 0x7fa161c838b0>
    │    └ 1
    └ <pymysql.connections.Connection object at 0x7fa161c838b0>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 775, in _read_query_result
    result.read()
    │      └ <function MySQLResult.read at 0x7fa252da34c0>
    └ <pymysql.connections.MySQLResult object at 0x7fa162ed1d90>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 1156, in read
    first_packet = self.connection._read_packet()
                   │    └ None
                   └ <pymysql.connections.MySQLResult object at 0x7fa162ed1d90>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/connections.py", line 725, in _read_packet
    packet.raise_for_error()
    │      └ <function MysqlPacket.raise_for_error at 0x7fa252d9aee0>
    └ <pymysql.protocol.MysqlPacket object at 0x7fa162ed1040>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/protocol.py", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
    │   │                     │    └ <member '_data' of 'MysqlPacket' objects>
    │   │                     └ <pymysql.protocol.MysqlPacket object at 0x7fa162ed1040>
    │   └ <function raise_mysql_exception at 0x7fa252e49670>
    └ <module 'pymysql.err' from '/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py'>
  File "/home/chase/.local/lib/python3.8/site-packages/pymysql/err.py", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
          │          │      └ "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'"
          │          └ 1062
          └ <class 'pymysql.err.IntegrityError'>

sqlalchemy.exc.IntegrityError: (pymysql.err.IntegrityError) (1062, "Duplicate entry '180.201.163.246:6800' for key 'device.PRIMARY'")
[SQL: UPDATE device SET server_id=%(server_id)s, ip=%(ip)s, username=%(username)s, password=%(password)s, address=%(address)s, port=%(port)s, valid=%(valid)s WHERE device.ip = %(ip_1)s]
[parameters: {'server_id': '180.201.163.246:6800', 'ip': '180.201.163.246', 'username': 'chase', 'password': '72742029520884372669226093543775450511683990225151511071961739264704849001206880341747553148598971468746672555266212578094824471484945455213480880280 ... (10 characters truncated) ... 95347933785775880058153426402614359839385021903330718595533619974276573252459619391230424639986082122513923850897487303105064621385154117654177465664', 'address': '/home/users/CT/pycharmproject/spiders/', 'port': 6800, 'valid': 1, 'ip_1': '180.201.163.246'}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
