{"remainingRequest":"D:\\Project\\spiderPlatform\\spider_platform\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Project\\spiderPlatform\\spider_platform\\src\\pages\\account_manage\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Project\\spiderPlatform\\spider_platform\\src\\pages\\account_manage\\index.vue","mtime":1649988418106},{"path":"D:\\Project\\spiderPlatform\\spider_platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1646988157970},{"path":"D:\\Project\\spiderPlatform\\spider_platform\\node_modules\\babel-loader\\lib\\index.js","mtime":1646988157969},{"path":"D:\\Project\\spiderPlatform\\spider_platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1646988157970},{"path":"D:\\Project\\spiderPlatform\\spider_platform\\node_modules\\vue-loader\\lib\\index.js","mtime":1646988174758}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQge21hcFN0YXRlfSBmcm9tICd2dWV4Jw0KaW1wb3J0IHtyZXF1ZXN0LCBNRVRIT0R9IGZyb20gJ0AvdXRpbHMvcmVxdWVzdCcNCmltcG9ydCB7QUNDT1VOVCwgQUNDT1VOVF9ERUxfQURELCBERUxfQUNDT1VOVH0gZnJvbSAnQC9zZXJ2aWNlcy9hcGknDQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ3Byb2pfbWFuYWdlJywNCiAgaTE4bjogcmVxdWlyZSgnLi9pMThuJyksDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGFkZEFjY291bnRJbmZvOiB7DQogICAgICAgICdwbGF0Zm9ybSc6ICcnLA0KICAgICAgICAndXNlcic6ICcnLA0KICAgICAgICAnY29va2llJzogJycsDQogICAgICAgICdwYXNzd29yZCc6ICcnLA0KICAgICAgICAndmFsaWQnOiB0cnVlLA0KICAgICAgICAnZGF0ZSc6ICcnDQogICAgICB9LA0KICAgICAgcGFnZVNpemU6IDcsDQogICAgICBjdXJyZW50UGFnZTogMSwNCiAgICAgIHRvdGFsOiA4LA0KICAgICAgdGFibGVEYXRhOiBbXSwNCiAgICAgIGNyZWF0ZURpYWxvZ1Zpc2libGU6IGZhbHNlLA0KICAgICAgZWRpdERpYWxvZ1Zpc2libGU6IGZhbHNlLA0KICAgICAgbW9uaXRvckRpYWxvZ1Zpc2libGU6IGZhbHNlDQogICAgfQ0KICB9LA0KICBtb3VudGVkKCkgew0KICAgIHRoaXMuZ2V0QWxsQWNjb3VudCgpDQogIH0sDQogIGFjdGl2YXRlZCgpIHsNCiAgICB0aGlzLmdldEFsbEFjY291bnQoKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgZ2V0QWxsQWNjb3VudCgpIHsNCiAgICAgIHJlcXVlc3QoQUNDT1VOVCwgTUVUSE9ELlBPU1QsIHsNCiAgICAgICAgcHJvamVjdF9uYW1lOiAiIiwNCiAgICAgIH0pLnRoZW4ocmVzID0+IHsNCiAgICAgICAgbGV0IGRhdGEgPSBbXQ0KICAgICAgICBmb3IgKGxldCBwbGF0TmFtZSBpbiByZXMuZGF0YS5hY2NvdW50KSB7DQogICAgICAgICAgZm9yIChsZXQgdXNlciBpbiByZXMuZGF0YS5hY2NvdW50W3BsYXROYW1lXSkNCiAgICAgICAgICAgIGRhdGEucHVzaCh7DQogICAgICAgICAgICAgIGlkOiByZXMuZGF0YS5hY2NvdW50W3BsYXROYW1lXVt1c2VyXVsnaWQnXSwNCiAgICAgICAgICAgICAgZGF0ZTogcmVzLmRhdGEuYWNjb3VudFtwbGF0TmFtZV1bdXNlcl1bJ2RhdGUnXSwNCiAgICAgICAgICAgICAgbmFtZTogcmVzLmRhdGEuYWNjb3VudFtwbGF0TmFtZV1bdXNlcl1bJ3VzZXInXSwNCiAgICAgICAgICAgICAgdmFsaWQ6IHJlcy5kYXRhLmFjY291bnRbcGxhdE5hbWVdW3VzZXJdWyd2YWxpZCddID09PSB0cnVlID8gIuacieaViCIgOiAi5aSx5pWIIg0KICAgICAgICAgICAgfSkNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLnRhYmxlRGF0YSA9IGRhdGENCiAgICAgICAgdGhpcy50b3RhbCA9IHRoaXMudGFibGVEYXRhLmxlbmd0aA0KICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnRhYmxlRGF0YSkNCiAgICAgIH0pDQogICAgfSwNCiAgICBoYW5kbGVEZWxldGUoaW5kZXgsIHJvdykgew0KICAgICAgY29uc29sZS5sb2coaW5kZXgsIHJvdykNCiAgICAgIHRoaXMuJGNvbmZpcm0oJ+atpOaTjeS9nOWwhuWIoOmZpOivpeeUqOaItywg5piv5ZCm57un57utPycsICfmj5DnpLonLCB7DQogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywNCiAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsDQogICAgICAgIHR5cGU6ICd3YXJuaW5nJywNCiAgICAgICAgY2VudGVyOiB0cnVlDQogICAgICB9KS50aGVuKCgpID0+IHsNCiAgICAgICAgcmVxdWVzdChERUxfQUNDT1VOVCwgTUVUSE9ELlBPU1QsIHsNCiAgICAgICAgICAnaWQnOiBbcm93LmlkXQ0KICAgICAgICB9KS50aGVuKHJlcyA9PiB7DQogICAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT09IDIwMCkgew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywNCiAgICAgICAgICAgICAgbWVzc2FnZTogJ+WIoOmZpOaIkOWKnyEnDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJywNCiAgICAgICAgICAgICAgbWVzc2FnZTogJ+WIoOmZpOWksei0pScNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0NCiAgICAgICAgICB0aGlzLmdldEFsbEFjY291bnQoKQ0KICAgICAgICB9KQ0KICAgICAgfSkuY2F0Y2goKCkgPT4gew0KICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICB0eXBlOiAnaW5mbycsDQogICAgICAgICAgbWVzc2FnZTogJ+W3suWPlua2iOWIoOmZpCcNCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9LA0KICAgIGhhbmRsZV91c2VyX0N1cnJlbnRDaGFuZ2UodmFsKSB7DQogICAgICB0aGlzLmN1cnJlbnRQYWdlID0gdmFsOw0KICAgIH0sDQogICAgY3JlYXRlU3BpZGVyKCkgew0KICAgICAgaWYgKHRoaXMuYWRkQWNjb3VudEluZm8ucGxhdGZvcm0gPT09ICcnIHx8IHRoaXMuYWRkQWNjb3VudEluZm8udXNlciA9PT0gJycgfHwgdGhpcy5hZGRBY2NvdW50SW5mby5jb29raWUgPT09ICcnIHx8IHRoaXMuYWRkQWNjb3VudEluZm8ucGFzc3dvcmQgPT09ICcnKSB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXlrozmlbTkv6Hmga8nLA0KICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJw0KICAgICAgICB9KTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuYWRkQWNjb3VudEluZm8uZGF0ZSA9IHRoaXMuZ2V0Tm93Rm9ybWF0VGltZSgpDQogICAgICAgIHJlcXVlc3QoQUNDT1VOVF9ERUxfQURELCBNRVRIT0QuUE9TVCwgew0KICAgICAgICAgIGFjY291bnRfaW5mb3M6IFt0aGlzLmFkZEFjY291bnRJbmZvXQ0KICAgICAgICB9KS50aGVuKHJlcyA9PiB7DQogICAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT09IDIwMCkgew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICAgIG1lc3NhZ2U6ICfmt7vliqDnlKjmiLfmiJDlip8nLA0KICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgICAgbWVzc2FnZTogJ+a3u+WKoOeUqOaIt+Wksei0pScsDQogICAgICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgfQ0KICAgICAgICAgIHRoaXMuZ2V0QWxsQWNjb3VudCgpDQogICAgICAgICAgdGhpcy5jcmVhdGVEaWFsb2dWaXNpYmxlID0gZmFsc2UNCiAgICAgICAgfSkNCiAgICAgIH0NCiAgICB9LA0KICAgIGdldE5vd0Zvcm1hdERheShub3dEYXRlKSB7DQogICAgICB2YXIgY2hhciA9ICItIjsNCiAgICAgIGlmIChub3dEYXRlID09IG51bGwpIHsNCiAgICAgICAgbm93RGF0ZSA9IG5ldyBEYXRlKCk7DQogICAgICB9DQogICAgICB2YXIgZGF5ID0gbm93RGF0ZS5nZXREYXRlKCk7DQogICAgICB2YXIgbW9udGggPSBub3dEYXRlLmdldE1vbnRoKCkgKyAxOy8v5rOo5oSP5pyI5Lu96ZyA6KaBKzENCiAgICAgIHZhciB5ZWFyID0gbm93RGF0ZS5nZXRGdWxsWWVhcigpOw0KICAgICAgLy/ooaXlhagw77yM5bm25ou85o6lDQogICAgICByZXR1cm4geWVhciArIGNoYXIgKyB0aGlzLmNvbXBsZXRlRGF0ZShtb250aCkgKyBjaGFyICsgdGhpcy5jb21wbGV0ZURhdGUoZGF5KTsNCiAgICB9LA0KICAgIGdldE5vd0Zvcm1hdFRpbWUoKSB7DQogICAgICB2YXIgbm93RGF0ZSA9IG5ldyBEYXRlKCk7DQogICAgICB2YXIgY29sb24gPSAiOiI7DQogICAgICB2YXIgaCA9IG5vd0RhdGUuZ2V0SG91cnMoKTsNCiAgICAgIHZhciBtID0gbm93RGF0ZS5nZXRNaW51dGVzKCk7DQogICAgICB2YXIgcyA9IG5vd0RhdGUuZ2V0U2Vjb25kcygpOw0KICAgICAgLy/ooaXlhagw77yM5bm25ou85o6lDQogICAgICByZXR1cm4gdGhpcy5nZXROb3dGb3JtYXREYXkobm93RGF0ZSkgKyAiICIgKyB0aGlzLmNvbXBsZXRlRGF0ZShoKSArIGNvbG9uICsgdGhpcy5jb21wbGV0ZURhdGUobSkgKyBjb2xvbiArIHRoaXMuY29tcGxldGVEYXRlKHMpOw0KICAgIH0sDQogICAgY29tcGxldGVEYXRlKHZhbHVlKSB7DQogICAgICByZXR1cm4gdmFsdWUgPCAxMCA/ICIwIiArIHZhbHVlIDogdmFsdWU7DQogICAgfQ0KICB9LA0KDQogIGNvbXB1dGVkOiB7DQogICAgLi4ubWFwU3RhdGUoJ3NldHRpbmcnLCBbJ3BhZ2VNaW5IZWlnaHQnXSksDQogICAgZGVzYygpIHsNCiAgICAgIHJldHVybiB0aGlzLiR0KCdkZXNjcmlwdGlvbicpDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/account_manage","sourcesContent":["<template>\r\n  <div class=\"new-page\" :style=\"`min-height: ${pageMinHeight}px`\">\r\n    <div class=\"create\">\r\n      <el-button size=\"medium\" @click=\"createDialogVisible=true\"> + 新建用户</el-button>\r\n    </div>\r\n    <div class=\"table\">\r\n      <el-table\r\n          :data=\"tableData.slice((currentPage-1)*pageSize,currentPage*pageSize)\"\r\n          style=\"width: 100%\">\r\n        <el-table-column\r\n            label=\"创建日期\"\r\n            sortable\r\n            width=\"360\">\r\n          <template slot-scope=\"scope\">\r\n            <i class=\"el-icon-time\"></i>\r\n            <span style=\"margin-left: 10px\">{{ scope.row.date }}</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column\r\n            prop=\"name\"\r\n            label=\"用户名称\"\r\n            min-width=\"180\">\r\n        </el-table-column>\r\n        <el-table-column\r\n            prop=\"valid\"\r\n            label=\"是否有效\"\r\n            min-width=\"180\">\r\n        </el-table-column>\r\n        <el-table-column\r\n            label=\"操作\"\r\n            min-width=\"180\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button\r\n                size=\"mini\"\r\n                type=\"danger\"\r\n                @click=\"handleDelete(scope.$index, scope.row)\">删除\r\n            </el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </div>\r\n    <div style=\"height:35px;width:100%\" class=\"clspage\">\r\n      <el-pagination align='center' @current-change=\"handle_user_CurrentChange\" layout=\"prev, pager, next\"\r\n                     :page-size=\"pageSize\" :current-page=\"currentPage\" :total=\"total\"></el-pagination>\r\n    </div>\r\n    <div class=\"dialog\">\r\n      <el-dialog\r\n          title=\"添加用户\"\r\n          :visible.sync=\"createDialogVisible\"\r\n          width=\"40%\"\r\n          center>\r\n        <span>平台名称：</span>\r\n        <el-input v-model=\"addAccountInfo.platform\" placeholder=\"请输入平台名称\"></el-input>\r\n        <span>Cookie：</span>\r\n        <el-input v-model=\"addAccountInfo.cookie\" placeholder=\"请输入Cookie\"></el-input>\r\n        <span>用户名：</span>\r\n        <el-input v-model=\"addAccountInfo.user\" placeholder=\"请输入用户名\"></el-input>\r\n        <span>密码：</span>\r\n        <el-input v-model=\"addAccountInfo.password\" placeholder=\"请输入密码\" show-password></el-input>\r\n        <span slot=\"footer\" class=\"dialog-footer\">\r\n    <el-button @click=\"createDialogVisible = false\">取 消</el-button>\r\n    <el-button type=\"primary\" @click=\"createSpider\">确 定</el-button>\r\n  </span>\r\n      </el-dialog>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapState} from 'vuex'\r\nimport {request, METHOD} from '@/utils/request'\r\nimport {ACCOUNT, ACCOUNT_DEL_ADD, DEL_ACCOUNT} from '@/services/api'\r\n\r\nexport default {\r\n  name: 'proj_manage',\r\n  i18n: require('./i18n'),\r\n  data() {\r\n    return {\r\n      addAccountInfo: {\r\n        'platform': '',\r\n        'user': '',\r\n        'cookie': '',\r\n        'password': '',\r\n        'valid': true,\r\n        'date': ''\r\n      },\r\n      pageSize: 7,\r\n      currentPage: 1,\r\n      total: 8,\r\n      tableData: [],\r\n      createDialogVisible: false,\r\n      editDialogVisible: false,\r\n      monitorDialogVisible: false\r\n    }\r\n  },\r\n  mounted() {\r\n    this.getAllAccount()\r\n  },\r\n  activated() {\r\n    this.getAllAccount()\r\n  },\r\n  methods: {\r\n    getAllAccount() {\r\n      request(ACCOUNT, METHOD.POST, {\r\n        project_name: \"\",\r\n      }).then(res => {\r\n        let data = []\r\n        for (let platName in res.data.account) {\r\n          for (let user in res.data.account[platName])\r\n            data.push({\r\n              id: res.data.account[platName][user]['id'],\r\n              date: res.data.account[platName][user]['date'],\r\n              name: res.data.account[platName][user]['user'],\r\n              valid: res.data.account[platName][user]['valid'] === true ? \"有效\" : \"失效\"\r\n            })\r\n        }\r\n        this.tableData = data\r\n        this.total = this.tableData.length\r\n        console.log(this.tableData)\r\n      })\r\n    },\r\n    handleDelete(index, row) {\r\n      console.log(index, row)\r\n      this.$confirm('此操作将删除该用户, 是否继续?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning',\r\n        center: true\r\n      }).then(() => {\r\n        request(DEL_ACCOUNT, METHOD.POST, {\r\n          'id': [row.id]\r\n        }).then(res => {\r\n          if (res.data.code === 200) {\r\n            this.$message({\r\n              type: 'success',\r\n              message: '删除成功!'\r\n            });\r\n          } else {\r\n            this.$message({\r\n              type: 'warning',\r\n              message: '删除失败'\r\n            });\r\n          }\r\n          this.getAllAccount()\r\n        })\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: 'info',\r\n          message: '已取消删除'\r\n        });\r\n      });\r\n    },\r\n    handle_user_CurrentChange(val) {\r\n      this.currentPage = val;\r\n    },\r\n    createSpider() {\r\n      if (this.addAccountInfo.platform === '' || this.addAccountInfo.user === '' || this.addAccountInfo.cookie === '' || this.addAccountInfo.password === '') {\r\n        this.$message({\r\n          message: '请输入完整信息',\r\n          type: 'warning'\r\n        });\r\n      } else {\r\n        this.addAccountInfo.date = this.getNowFormatTime()\r\n        request(ACCOUNT_DEL_ADD, METHOD.POST, {\r\n          account_infos: [this.addAccountInfo]\r\n        }).then(res => {\r\n          if (res.data.code === 200) {\r\n            this.$message({\r\n              message: '添加用户成功',\r\n              type: 'success'\r\n            });\r\n          } else {\r\n            this.$message({\r\n              message: '添加用户失败',\r\n              type: 'warning'\r\n            });\r\n          }\r\n          this.getAllAccount()\r\n          this.createDialogVisible = false\r\n        })\r\n      }\r\n    },\r\n    getNowFormatDay(nowDate) {\r\n      var char = \"-\";\r\n      if (nowDate == null) {\r\n        nowDate = new Date();\r\n      }\r\n      var day = nowDate.getDate();\r\n      var month = nowDate.getMonth() + 1;//注意月份需要+1\r\n      var year = nowDate.getFullYear();\r\n      //补全0，并拼接\r\n      return year + char + this.completeDate(month) + char + this.completeDate(day);\r\n    },\r\n    getNowFormatTime() {\r\n      var nowDate = new Date();\r\n      var colon = \":\";\r\n      var h = nowDate.getHours();\r\n      var m = nowDate.getMinutes();\r\n      var s = nowDate.getSeconds();\r\n      //补全0，并拼接\r\n      return this.getNowFormatDay(nowDate) + \" \" + this.completeDate(h) + colon + this.completeDate(m) + colon + this.completeDate(s);\r\n    },\r\n    completeDate(value) {\r\n      return value < 10 ? \"0\" + value : value;\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    ...mapState('setting', ['pageMinHeight']),\r\n    desc() {\r\n      return this.$t('description')\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"index\";\r\n</style>"]}]}