{"remainingRequest":"D:\\Project\\spiderPlatform\\spider_platform\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Project\\spiderPlatform\\spider_platform\\src\\pages\\device_manage\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Project\\spiderPlatform\\spider_platform\\src\\pages\\device_manage\\index.vue","mtime":1649988418117},{"path":"D:\\Project\\spiderPlatform\\spider_platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1646988157970},{"path":"D:\\Project\\spiderPlatform\\spider_platform\\node_modules\\babel-loader\\lib\\index.js","mtime":1646988157969},{"path":"D:\\Project\\spiderPlatform\\spider_platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1646988157970},{"path":"D:\\Project\\spiderPlatform\\spider_platform\\node_modules\\vue-loader\\lib\\index.js","mtime":1646988174758}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQge21hcFN0YXRlfSBmcm9tICd2dWV4Jw0KaW1wb3J0IHtyZXF1ZXN0LCBNRVRIT0R9IGZyb20gJ0AvdXRpbHMvcmVxdWVzdCcNCmltcG9ydCB7REVWSUNFLCBERVZJQ0VfREVMX0FERH0gZnJvbSAnQC9zZXJ2aWNlcy9hcGknDQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ3Byb2pfbWFuYWdlJywNCiAgaTE4bjogcmVxdWlyZSgnLi9pMThuJyksDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHBhZ2VTaXplOiA3LA0KICAgICAgY3VycmVudFBhZ2U6IDEsDQogICAgICB0b3RhbDogMTAwLA0KICAgICAgdGFibGVEYXRhOiBbXSwNCiAgICAgIGFkZERldmljZUluZm9yOiB7DQogICAgICAgICdpcCc6ICcnLA0KICAgICAgICAndXNlcm5hbWUnOiAnJywNCiAgICAgICAgJ3Bhc3N3b3JkJzogJycsDQogICAgICAgICdhZGRyZXNzJzogJycsDQogICAgICAgICdwb3J0JzogJycsDQogICAgICAgICd2YWxpZCc6IHRydWUNCiAgICAgIH0sDQogICAgICBhZGREZXZpY2VzOiBbXSwNCiAgICAgIGNyZWF0ZURpYWxvZ1Zpc2libGU6IGZhbHNlLA0KICAgICAgZWRpdERpYWxvZ1Zpc2libGU6IGZhbHNlLA0KICAgICAgbW9uaXRvckRpYWxvZ1Zpc2libGU6IGZhbHNlDQogICAgfQ0KICB9LA0KICBhY3RpdmF0ZWQoKSB7DQogICB0aGlzLmdldEFsbERldmljZXMoKQ0KICB9LA0KICBtb3VudGVkKCkgew0KICAgIHRoaXMuZ2V0QWxsRGV2aWNlcygpDQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBnZXRBbGxEZXZpY2VzKCkgew0KICAgICAgcmVxdWVzdChERVZJQ0UsIE1FVEhPRC5QT1NULCB7DQogICAgICAgIHByb2plY3RfbmFtZTogIiINCiAgICAgIH0pLnRoZW4ocmVzID0+IHsNCiAgICAgICAgdGhpcy50YWJsZURhdGEgPSBbXQ0KICAgICAgICBmb3IgKGxldCBrZXkgaW4gcmVzLmRhdGEubWVzc2FnZSkgew0KICAgICAgICAgIHRoaXMudGFibGVEYXRhLnB1c2goDQogICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAiYWRkcmVzcyI6IHJlcy5kYXRhLm1lc3NhZ2Vba2V5XVsiYWRkcmVzcyJdLA0KICAgICAgICAgICAgICAgICJpcCI6IGtleSwNCiAgICAgICAgICAgICAgICAicG9ydCI6IHJlcy5kYXRhLm1lc3NhZ2Vba2V5XVsicG9ydCJdLA0KICAgICAgICAgICAgICAgICJ1c2VybmFtZSI6IHJlcy5kYXRhLm1lc3NhZ2Vba2V5XVsidXNlcm5hbWUiXSwNCiAgICAgICAgICAgICAgICAidmFsaWQiOiByZXMuZGF0YS5tZXNzYWdlW2tleV1bInZhbGlkIl0gPyAi5pyJ5pWIIiA6ICLml6DmlYgiDQogICAgICAgICAgICAgIH0NCiAgICAgICAgICApDQogICAgICAgIH0NCiAgICAgICAgdGhpcy50b3RhbCA9IHRoaXMudGFibGVEYXRhLmxlbmd0aA0KICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnRhYmxlRGF0YSkNCiAgICAgIH0pDQoNCiAgICB9LA0KICAgIGhhbmRsZURlbGV0ZShpbmRleCwgcm93KSB7DQogICAgICB0aGlzLiRjb25maXJtKCfmraTmk43kvZzlsIbliKDpmaTor6XliIbluIPlvI/orr7lpIcsIOaYr+WQpue7p+e7rT8nLCAn5o+Q56S6Jywgew0KICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsDQogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLA0KICAgICAgICB0eXBlOiAnd2FybmluZycsDQogICAgICAgIGNlbnRlcjogdHJ1ZQ0KICAgICAgfSkudGhlbigoKSA9PiB7DQogICAgICAgICByZXF1ZXN0KERFVklDRV9ERUxfQURELCBNRVRIT0QuUE9TVCwgew0KICAgICAgICAgICJjb3ZlciI6IGZhbHNlLA0KICAgICAgICAgICJhZGRfZGV2aWNlcyI6IFtdLA0KICAgICAgICAgICJybV9kZXZpY2VzIjogW3Jvdy5pcF0NCiAgICAgICAgfSkudGhlbihyZXMgPT4gew0KICAgICAgICAgIGNvbnNvbGUubG9nKHJlcykNCiAgICAgICAgICAgIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhyZXMuZGF0YS5ybV9lcnJvcikubGVuZ3RoICE9IDApIHsNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgICBtZXNzYWdlOiAn5Yig6Zmk5aSx6LSlJywNCiAgICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhpcy5jcmVhdGVEaWFsb2dWaXNpYmxlID0gZmFsc2UNCiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgICBtZXNzYWdlOiAn5Yig6Zmk5oiQ5YqfJywNCiAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIHRoaXMuZ2V0QWxsRGV2aWNlcygpDQogICAgICAgICAgfQ0KICAgICAgICAgfSkNCiAgICAgIH0pLmNhdGNoKCgpID0+IHsNCiAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgdHlwZTogJ2luZm8nLA0KICAgICAgICAgIG1lc3NhZ2U6ICflt7Llj5bmtojliKDpmaQnDQogICAgICAgIH0pOw0KICAgICAgfSk7DQogICAgfSwNCiAgICBoYW5kbGVfdXNlcl9DdXJyZW50Q2hhbmdlKHZhbCkgew0KICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IHZhbDsNCiAgICB9LA0KICAgIGNyZWF0ZURldmljZSgpIHsNCg0KICAgICAgLy/or7fmsYLmnI3liqHlmajmlrDlu7rliIbluIPlvI/orr7lpIcNCiAgICAgIGlmICh0aGlzLmFkZERldmljZUluZm9yLnBvcnQgPT0gJycgfHwgdGhpcy5hZGREZXZpY2VJbmZvci51c2VybmFtZSA9PSAnJyB8fCB0aGlzLmFkZERldmljZUluZm9yLnBhc3N3b3JkID09ICcnIHx8IHRoaXMuYWRkRGV2aWNlSW5mb3IuYWRkcmVzcyA9PSAnJyB8fCB0aGlzLmFkZERldmljZUluZm9yLmlwID09ICcnKSB7DQogICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXlrozmlbTkv6Hmga8nLA0KICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJw0KICAgICAgICB9KTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGxldCBhZGREZXZpY2VzID0gW3RoaXMuYWRkRGV2aWNlSW5mb3JdDQogICAgICAgIHJlcXVlc3QoREVWSUNFX0RFTF9BREQsIE1FVEhPRC5QT1NULCB7DQogICAgICAgICAgImNvdmVyIjogZmFsc2UsDQogICAgICAgICAgImFkZF9kZXZpY2VzIjogYWRkRGV2aWNlcywNCiAgICAgICAgICAicm1fZGV2aWNlcyI6IFtdDQogICAgICAgIH0pLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMocmVzLmRhdGEuYWRkX2Vycm9yKS5sZW5ndGggIT0gMCkgew0KICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICAgIG1lc3NhZ2U6ICforr7lpIdpcOmHjeWkje+8jOWIm+W7uuWksei0pScsDQogICAgICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMuY3JlYXRlRGlhbG9nVmlzaWJsZSA9IGZhbHNlDQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgICAgbWVzc2FnZTogJ+aWsOW7uuWIhuW4g+W8j+iuvuWkh+aIkOWKnycsDQogICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB0aGlzLmdldEFsbERldmljZXMoKQ0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCg0KICAgICAgfQ0KICAgIH0sDQoNCiAgfSwNCg0KICBjb21wdXRlZDogew0KICAgIC4uLm1hcFN0YXRlKCdzZXR0aW5nJywgWydwYWdlTWluSGVpZ2h0J10pLA0KICAgIGRlc2MoKSB7DQogICAgICByZXR1cm4gdGhpcy4kdCgnZGVzY3JpcHRpb24nKQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+EA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/device_manage","sourcesContent":["<template>\r\n  <div class=\"new-page\" :style=\"`min-height: ${pageMinHeight}px`\">\r\n    <div class=\"create\">\r\n      <el-button size=\"medium\" @click=\"createDialogVisible=true\"> + 添加分布式设备</el-button>\r\n    </div>\r\n    <div class=\"table\">\r\n      <el-table\r\n          :data=\"tableData.slice((currentPage-1)*pageSize,currentPage*pageSize)\"\r\n          style=\"width: 100%\">\r\n        <el-table-column\r\n            label=\"设备地址\"\r\n            min-width=\"100\">\r\n          <template slot-scope=\"scope\">\r\n            <span style=\"margin-left: 10px\">{{ scope.row.address }}</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column\r\n            prop=\"ip\"\r\n            label=\"设备IP\"\r\n            min-width=\"100\">\r\n        </el-table-column>\r\n        <el-table-column\r\n            prop=\"port\"\r\n            label=\"端口号\"\r\n            min-width=\"100\">\r\n        </el-table-column>\r\n        <el-table-column\r\n            prop=\"username\"\r\n            label=\"用户名\"\r\n            min-width=\"100\">\r\n        </el-table-column>\r\n        <el-table-column\r\n            prop=\"valid\"\r\n            label=\"是否有效\"\r\n            min-width=\"100\">\r\n        </el-table-column>\r\n        <el-table-column\r\n            label=\"操作\"\r\n            min-width=\"100\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button\r\n                size=\"mini\"\r\n                type=\"danger\"\r\n                @click=\"handleDelete(scope.$index, scope.row)\">删除\r\n            </el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </div>\r\n    <div style=\"height:35px;width:100%\" class=\"clspage\">\r\n      <el-pagination align='center' @current-change=\"handle_user_CurrentChange\" layout=\"prev, pager, next\"\r\n                     :page-size=\"pageSize\" :current-page=\"currentPage\" :total=\"total\"></el-pagination>\r\n    </div>\r\n    <div class=\"dialog\">\r\n      <el-dialog\r\n          title=\"新建设备\"\r\n          :visible.sync=\"createDialogVisible\"\r\n          width=\"40%\"\r\n          center>\r\n        <span>设备ip：</span>\r\n        <el-input v-model=\"addDeviceInfor.ip\" placeholder=\"请输入ip\"></el-input>\r\n        <span>用户名：</span>\r\n        <el-input v-model=\"addDeviceInfor.username\" placeholder=\"请输入用户名\"></el-input>\r\n        <span>密码：</span>\r\n        <el-input v-model=\"addDeviceInfor.password\" placeholder=\"请输入密码\"></el-input>\r\n        <span>设备地址：</span>\r\n        <el-input v-model=\"addDeviceInfor.address\" placeholder=\"请输入设备地址\"></el-input>\r\n        <span>端口号：</span>\r\n        <el-input v-model=\"addDeviceInfor.port\" placeholder=\"请输入端口号\"></el-input>\r\n        <span slot=\"footer\" class=\"dialog-footer\">\r\n    <el-button @click=\"createDialogVisible = false\">取 消</el-button>\r\n    <el-button type=\"primary\" @click=\"createDevice\">确 定</el-button>\r\n  </span>\r\n      </el-dialog>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {mapState} from 'vuex'\r\nimport {request, METHOD} from '@/utils/request'\r\nimport {DEVICE, DEVICE_DEL_ADD} from '@/services/api'\r\n\r\nexport default {\r\n  name: 'proj_manage',\r\n  i18n: require('./i18n'),\r\n  data() {\r\n    return {\r\n      pageSize: 7,\r\n      currentPage: 1,\r\n      total: 100,\r\n      tableData: [],\r\n      addDeviceInfor: {\r\n        'ip': '',\r\n        'username': '',\r\n        'password': '',\r\n        'address': '',\r\n        'port': '',\r\n        'valid': true\r\n      },\r\n      addDevices: [],\r\n      createDialogVisible: false,\r\n      editDialogVisible: false,\r\n      monitorDialogVisible: false\r\n    }\r\n  },\r\n  activated() {\r\n   this.getAllDevices()\r\n  },\r\n  mounted() {\r\n    this.getAllDevices()\r\n  },\r\n  methods: {\r\n    getAllDevices() {\r\n      request(DEVICE, METHOD.POST, {\r\n        project_name: \"\"\r\n      }).then(res => {\r\n        this.tableData = []\r\n        for (let key in res.data.message) {\r\n          this.tableData.push(\r\n              {\r\n                \"address\": res.data.message[key][\"address\"],\r\n                \"ip\": key,\r\n                \"port\": res.data.message[key][\"port\"],\r\n                \"username\": res.data.message[key][\"username\"],\r\n                \"valid\": res.data.message[key][\"valid\"] ? \"有效\" : \"无效\"\r\n              }\r\n          )\r\n        }\r\n        this.total = this.tableData.length\r\n        console.log(this.tableData)\r\n      })\r\n\r\n    },\r\n    handleDelete(index, row) {\r\n      this.$confirm('此操作将删除该分布式设备, 是否继续?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning',\r\n        center: true\r\n      }).then(() => {\r\n         request(DEVICE_DEL_ADD, METHOD.POST, {\r\n          \"cover\": false,\r\n          \"add_devices\": [],\r\n          \"rm_devices\": [row.ip]\r\n        }).then(res => {\r\n          console.log(res)\r\n            if (Object.getOwnPropertyNames(res.data.rm_error).length != 0) {\r\n            this.$message({\r\n              message: '删除失败',\r\n              type: 'warning'\r\n            });\r\n          } else {\r\n            this.createDialogVisible = false\r\n            this.$message({\r\n              message: '删除成功',\r\n              type: 'success'\r\n            });\r\n            this.getAllDevices()\r\n          }\r\n         })\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: 'info',\r\n          message: '已取消删除'\r\n        });\r\n      });\r\n    },\r\n    handle_user_CurrentChange(val) {\r\n      this.currentPage = val;\r\n    },\r\n    createDevice() {\r\n\r\n      //请求服务器新建分布式设备\r\n      if (this.addDeviceInfor.port == '' || this.addDeviceInfor.username == '' || this.addDeviceInfor.password == '' || this.addDeviceInfor.address == '' || this.addDeviceInfor.ip == '') {\r\n        this.$message({\r\n          message: '请输入完整信息',\r\n          type: 'warning'\r\n        });\r\n      } else {\r\n        let addDevices = [this.addDeviceInfor]\r\n        request(DEVICE_DEL_ADD, METHOD.POST, {\r\n          \"cover\": false,\r\n          \"add_devices\": addDevices,\r\n          \"rm_devices\": []\r\n        }).then(res => {\r\n          if (Object.getOwnPropertyNames(res.data.add_error).length != 0) {\r\n            this.$message({\r\n              message: '设备ip重复，创建失败',\r\n              type: 'warning'\r\n            });\r\n          } else {\r\n            this.createDialogVisible = false\r\n            this.$message({\r\n              message: '新建分布式设备成功',\r\n              type: 'success'\r\n            });\r\n            this.getAllDevices()\r\n          }\r\n        })\r\n\r\n      }\r\n    },\r\n\r\n  },\r\n\r\n  computed: {\r\n    ...mapState('setting', ['pageMinHeight']),\r\n    desc() {\r\n      return this.$t('description')\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"index\";\r\n</style>"]}]}