{"remainingRequest":"D:\\Project\\spiderPlatform\\spider_platform\\node_modules\\babel-loader\\lib\\index.js!D:\\Project\\spiderPlatform\\spider_platform\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\Project\\spiderPlatform\\spider_platform\\src\\utils\\authority-utils.js","dependencies":[{"path":"D:\\Project\\spiderPlatform\\spider_platform\\src\\utils\\authority-utils.js","mtime":1646988546897},{"path":"D:\\Project\\spiderPlatform\\spider_platform\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1646988157970},{"path":"D:\\Project\\spiderPlatform\\spider_platform\\node_modules\\babel-loader\\lib\\index.js","mtime":1646988157969},{"path":"D:\\Project\\spiderPlatform\\spider_platform\\node_modules\\eslint-loader\\index.js","mtime":1646988172536}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleCI7CmltcG9ydCBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciBmcm9tICJEOi9Qcm9qZWN0L3NwaWRlclBsYXRmb3JtL3NwaWRlcl9wbGF0Zm9ybS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciI7CmltcG9ydCBfdG9Db25zdW1hYmxlQXJyYXkgZnJvbSAiRDovUHJvamVjdC9zcGlkZXJQbGF0Zm9ybS9zcGlkZXJfcGxhdGZvcm0vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5IjsKaW1wb3J0IF90eXBlb2YgZnJvbSAiRDovUHJvamVjdC9zcGlkZXJQbGF0Zm9ybS9zcGlkZXJfcGxhdGZvcm0vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3R5cGVvZiI7CgovKioNCiAqIOWIpOaWreaYr+WQpuaciei3r+eUseeahOadg+mZkA0KICogQHBhcmFtIGF1dGhvcml0eSDot6/nlLHmnYPpmZDphY3nva4NCiAqIEBwYXJhbSBwZXJtaXNzaW9ucyDnlKjmiLfmnYPpmZDpm4blkIgNCiAqIEByZXR1cm5zIHtib29sZWFufCp9DQogKi8KZnVuY3Rpb24gaGFzUGVybWlzc2lvbihhdXRob3JpdHksIHBlcm1pc3Npb25zKSB7CiAgdmFyIHJlcXVpcmVkID0gJyonOwoKICBpZiAodHlwZW9mIGF1dGhvcml0eSA9PT0gJ3N0cmluZycpIHsKICAgIHJlcXVpcmVkID0gYXV0aG9yaXR5OwogIH0gZWxzZSBpZiAoX3R5cGVvZihhdXRob3JpdHkpID09PSAnb2JqZWN0JykgewogICAgcmVxdWlyZWQgPSBhdXRob3JpdHkucGVybWlzc2lvbjsKICB9CgogIHJldHVybiByZXF1aXJlZCA9PT0gJyonIHx8IHBlcm1pc3Npb25zICYmIHBlcm1pc3Npb25zLmZpbmRJbmRleChmdW5jdGlvbiAoaXRlbSkgewogICAgcmV0dXJuIGl0ZW0gPT09IHJlcXVpcmVkIHx8IGl0ZW0uaWQgPT09IHJlcXVpcmVkOwogIH0pICE9PSAtMTsKfQovKioNCiAqIOWIpOaWreaYr+WQpuaciei3r+eUsemcgOimgeeahOinkuiJsg0KICogQHBhcmFtIGF1dGhvcml0eSDot6/nlLHmnYPpmZDphY3nva4NCiAqIEBwYXJhbSByb2xlcyDnlKjmiLfop5LoibLpm4blkIgNCiAqLwoKCmZ1bmN0aW9uIGhhc1JvbGUoYXV0aG9yaXR5LCByb2xlcykgewogIHZhciByZXF1aXJlZCA9IHVuZGVmaW5lZDsKCiAgaWYgKF90eXBlb2YoYXV0aG9yaXR5KSA9PT0gJ29iamVjdCcpIHsKICAgIHJlcXVpcmVkID0gYXV0aG9yaXR5LnJvbGU7CiAgfQoKICByZXR1cm4gYXV0aG9yaXR5ID09PSAnKicgfHwgaGFzQW55Um9sZShyZXF1aXJlZCwgcm9sZXMpOwp9Ci8qKg0KICog5Yik5pat5piv5ZCm5pyJ6ZyA6KaB55qE5Lu75oSP5LiA5Liq6KeS6ImyDQogKiBAcGFyYW0gcmVxdWlyZWQge1N0cmluZyB8IEFycmF5W1N0cmluZ119IOmcgOimgeeahOinkuiJsu+8jOWPr+S7peaYr+WNleS4quinkuiJsuaIluiAheS4gOS4quinkuiJsuaVsOe7hA0KICogQHBhcmFtIHJvbGVzIOaLpeacieeahOinkuiJsg0KICogQHJldHVybnMge2Jvb2xlYW59DQogKi8KCgpmdW5jdGlvbiBoYXNBbnlSb2xlKHJlcXVpcmVkLCByb2xlcykgewogIGlmICghcmVxdWlyZWQpIHsKICAgIHJldHVybiBmYWxzZTsKICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkocmVxdWlyZWQpKSB7CiAgICByZXR1cm4gcm9sZXMuZmluZEluZGV4KGZ1bmN0aW9uIChyb2xlKSB7CiAgICAgIHJldHVybiByZXF1aXJlZC5maW5kSW5kZXgoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbSA9PT0gcm9sZSB8fCBpdGVtID09PSByb2xlLmlkOwogICAgICB9KSAhPT0gLTE7CiAgICB9KSAhPT0gLTE7CiAgfSBlbHNlIHsKICAgIHJldHVybiByb2xlcy5maW5kSW5kZXgoZnVuY3Rpb24gKHJvbGUpIHsKICAgICAgcmV0dXJuIHJvbGUgPT09IHJlcXVpcmVkIHx8IHJvbGUuaWQgPT09IHJlcXVpcmVkOwogICAgfSkgIT09IC0xOwogIH0KfQovKioNCiAqIOi3r+eUseadg+mZkOagoemqjA0KICogQHBhcmFtIHJvdXRlIOi3r+eUsQ0KICogQHBhcmFtIHBlcm1pc3Npb25zIOeUqOaIt+adg+mZkOmbhuWQiA0KICogQHBhcmFtIHJvbGVzIOeUqOaIt+inkuiJsumbhuWQiA0KICogQHJldHVybnMge2Jvb2xlYW59DQogKi8KCgpmdW5jdGlvbiBoYXNBdXRob3JpdHkocm91dGUsIHBlcm1pc3Npb25zLCByb2xlcykgewogIHZhciBhdXRob3JpdGllcyA9IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkocm91dGUubWV0YS5wQXV0aG9yaXRpZXMpLCBbcm91dGUubWV0YS5hdXRob3JpdHldKTsKCiAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGF1dGhvcml0aWVzKSwKICAgICAgX3N0ZXA7CgogIHRyeSB7CiAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICB2YXIgYXV0aG9yaXR5ID0gX3N0ZXAudmFsdWU7CgogICAgICBpZiAoIWhhc1Blcm1pc3Npb24oYXV0aG9yaXR5LCBwZXJtaXNzaW9ucykgJiYgIWhhc1JvbGUoYXV0aG9yaXR5LCByb2xlcykpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9pdGVyYXRvci5lKGVycik7CiAgfSBmaW5hbGx5IHsKICAgIF9pdGVyYXRvci5mKCk7CiAgfQoKICByZXR1cm4gdHJ1ZTsKfQovKioNCiAqIOagueaNruadg+mZkOmFjee9rui/h+a7pOiPnOWNleaVsOaNrg0KICogQHBhcmFtIG1lbnVEYXRhDQogKiBAcGFyYW0gcGVybWlzc2lvbnMNCiAqIEBwYXJhbSByb2xlcw0KICovCgoKZnVuY3Rpb24gZmlsdGVyTWVudShtZW51RGF0YSwgcGVybWlzc2lvbnMsIHJvbGVzKSB7CiAgcmV0dXJuIG1lbnVEYXRhLmZpbHRlcihmdW5jdGlvbiAobWVudSkgewogICAgaWYgKG1lbnUubWV0YSAmJiBtZW51Lm1ldGEuaW52aXNpYmxlID09PSB1bmRlZmluZWQpIHsKICAgICAgaWYgKCFoYXNBdXRob3JpdHkobWVudSwgcGVybWlzc2lvbnMsIHJvbGVzKSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfQoKICAgIGlmIChtZW51LmNoaWxkcmVuICYmIG1lbnUuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICBtZW51LmNoaWxkcmVuID0gZmlsdGVyTWVudShtZW51LmNoaWxkcmVuLCBwZXJtaXNzaW9ucywgcm9sZXMpOwogICAgfQoKICAgIHJldHVybiB0cnVlOwogIH0pOwp9CgpleHBvcnQgeyBmaWx0ZXJNZW51LCBoYXNBdXRob3JpdHkgfTs="},{"version":3,"sources":["D:/Project/spiderPlatform/spider_platform/src/utils/authority-utils.js"],"names":["hasPermission","authority","permissions","required","permission","findIndex","item","id","hasRole","roles","undefined","role","hasAnyRole","Array","isArray","hasAuthority","route","authorities","meta","pAuthorities","filterMenu","menuData","filter","menu","invisible","children","length"],"mappings":"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","sourcesContent":["/**\r\n * 判断是否有路由的权限\r\n * @param authority 路由权限配置\r\n * @param permissions 用户权限集合\r\n * @returns {boolean|*}\r\n */\r\nfunction hasPermission(authority, permissions) {\r\n  let required = '*'\r\n  if (typeof authority === 'string') {\r\n    required = authority\r\n  } else if (typeof authority === 'object') {\r\n    required = authority.permission\r\n  }\r\n  return required === '*' || (permissions && permissions.findIndex(item => item === required || item.id === required) !== -1)\r\n}\r\n\r\n/**\r\n * 判断是否有路由需要的角色\r\n * @param authority 路由权限配置\r\n * @param roles 用户角色集合\r\n */\r\nfunction hasRole(authority, roles) {\r\n  let required = undefined\r\n  if (typeof authority === 'object') {\r\n    required = authority.role\r\n  }\r\n  return authority === '*' || hasAnyRole(required, roles)\r\n}\r\n\r\n/**\r\n * 判断是否有需要的任意一个角色\r\n * @param required {String | Array[String]} 需要的角色，可以是单个角色或者一个角色数组\r\n * @param roles 拥有的角色\r\n * @returns {boolean}\r\n */\r\nfunction hasAnyRole(required, roles) {\r\n  if (!required) {\r\n    return false\r\n  } else if(Array.isArray(required)) {\r\n    return roles.findIndex(role => {\r\n      return required.findIndex(item => item === role || item === role.id) !== -1\r\n    }) !== -1\r\n  } else {\r\n    return roles.findIndex(role => role === required || role.id === required) !== -1\r\n  }\r\n}\r\n\r\n/**\r\n * 路由权限校验\r\n * @param route 路由\r\n * @param permissions 用户权限集合\r\n * @param roles 用户角色集合\r\n * @returns {boolean}\r\n */\r\nfunction hasAuthority(route, permissions, roles) {\r\n  const authorities = [...route.meta.pAuthorities, route.meta.authority]\r\n  for (let authority of authorities) {\r\n    if (!hasPermission(authority, permissions) && !hasRole(authority, roles)) {\r\n      return false\r\n    }\r\n  }\r\n  return true\r\n}\r\n\r\n/**\r\n * 根据权限配置过滤菜单数据\r\n * @param menuData\r\n * @param permissions\r\n * @param roles\r\n */\r\nfunction filterMenu(menuData, permissions, roles) {\r\n  return menuData.filter(menu => {\r\n    if (menu.meta && menu.meta.invisible === undefined) {\r\n      if (!hasAuthority(menu, permissions, roles)) {\r\n        return false\r\n      }\r\n    }\r\n    if (menu.children && menu.children.length > 0) {\r\n      menu.children = filterMenu(menu.children, permissions, roles)\r\n    }\r\n    return true\r\n  })\r\n}\r\n\r\nexport {filterMenu, hasAuthority}\r\n"]}]}